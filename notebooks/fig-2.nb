(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61618,       1616]
NotebookOptionsPosition[     54431,       1508]
NotebookOutlinePosition[     54823,       1525]
CellTagsIndexPosition[     54780,       1522]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"<<", "Eidomatica`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.656408015683893*^9, 3.6564080175889187`*^9}, {
   3.656658465976006*^9, 3.656658475361671*^9}, {3.656678958137349*^9, 
   3.656678963633894*^9}, {3.656679786831828*^9, 3.656679787185676*^9}, {
   3.663898099007929*^9, 3.6638981034679117`*^9}, {3.664886328414156*^9, 
   3.664886333066451*^9}, {3.674879302267021*^9, 3.674879303669796*^9}, {
   3.679717752403764*^9, 3.679717773766089*^9}, {3.679741784989903*^9, 
   3.679741786075618*^9}, 3.78263067193643*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"b63ba021-b85d-45b0-ad55-3dcdfefbd11c"],

Cell[CellGroupData[{

Cell["Import data", "Section",
 CellChangeTimes->{{3.66470613128232*^9, 
  3.664706132946227*^9}},ExpressionUUID->"b027ae07-e0de-45be-a8ee-\
222be405f984"],

Cell[CellGroupData[{

Cell["Directories", "Subsection",
 CellChangeTimes->{{3.664706280966886*^9, 
  3.664706282494669*^9}},ExpressionUUID->"5c3bc57c-6381-4c44-a4c2-\
5e3c84c1cb93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sample1", "=", "\"\<../results/sample-1/plots/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sample2", "=", "\"\<./results/sample-2/plots/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sample3", "=", "\"\<./results/sample-3/plots/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"directories", "=", 
  RowBox[{"{", 
   RowBox[{"sample1", ",", "sample2", ",", "sample3"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.664706234130728*^9, 3.66470627644689*^9}, {
  3.664706505223824*^9, 3.664706529048523*^9}, {3.6647942076047497`*^9, 
  3.664794217050798*^9}, {3.782629411270833*^9, 3.782629477711748*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"2007e4d1-9919-4240-80f7-a4a4834975c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cell Position Data", "Subsection",
 CellChangeTimes->{{3.6647061405621758`*^9, 3.6647061428659983`*^9}, {
  3.782629546048731*^9, 
  3.782629552067387*^9}},ExpressionUUID->"45375a06-0300-4f18-af04-\
66e6bfe2635a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"{", 
    RowBox[{"sample1", ",", "sample2", ",", "sample3"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.784552926815207*^9, 3.7845529316827297`*^9}, 
   3.784553671808735*^9, {3.7845539108647547`*^9, 
   3.7845539177989883`*^9}},ExpressionUUID->"357f5151-602c-40f2-b575-\
e5d434a62eb6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cellPositions1", "=", 
   RowBox[{
   "Import", "[", "\"\<../test-data/sample-1/cell-positions.csv\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPositions2", "=", 
   RowBox[{
   "Import", "[", "\"\<../test-data/sample-2/cell-positions.csv\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPositions3", "=", 
   RowBox[{
   "Import", "[", "\"\<../test-data/sample-3/cell-positions.csv\>\"", "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.7846093369374847`*^9, 3.784609345944757*^9}, {
  3.784874577105834*^9, 3.784874610405644*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"960e0049-2f51-4726-b436-d857ec7ce69c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cellPosTmp1", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"cellPositions1", ",", "Last"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPosTmp2", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"cellPositions2", ",", "Last"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPosTmp3", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"cellPositions3", ",", "Last"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784609845665949*^9, 3.7846098679747467`*^9}, {
  3.784874691962468*^9, 3.784874710900468*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"59b3fc95-31ec-49ab-9468-c8c8fb98f5fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cellPosTmp1", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"z", ",", 
      RowBox[{"GatherBy", "[", 
       RowBox[{"z", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}]}], "]"}], "/@", 
    "cellPosTmp1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPosTmp2", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"z", ",", 
      RowBox[{"GatherBy", "[", 
       RowBox[{"z", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}]}], "]"}], "/@", 
    "cellPosTmp2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPosTmp3", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"z", ",", 
      RowBox[{"GatherBy", "[", 
       RowBox[{"z", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}]}], "]"}], "/@", 
    "cellPosTmp3"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7846098706205397`*^9, 3.784609907539209*^9}, {
  3.784609954632127*^9, 3.784609982066104*^9}, {3.784874716277769*^9, 
  3.7848747302000017`*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"09f5ec6a-6b75-4709-bf58-1af5d91af2de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cellPositions1", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"#", ",", "3"}], "]"}], "&"}], ",", "cellPosTmp1", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPositions2", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"#", ",", "3"}], "]"}], "&"}], ",", "cellPosTmp2", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellPositions3", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"#", ",", "3"}], "]"}], "&"}], ",", "cellPosTmp3", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784610065756577*^9, 3.784610120082553*^9}, {
  3.784874734284423*^9, 3.7848747493099003`*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"8153c0fd-f6fc-453d-a04c-6d22a9520a76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cellPositions", "=", 
   RowBox[{"{", 
    RowBox[{"cellPositions1", ",", "cellPositions2", ",", "cellPositions3"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7848745997566833`*^9, 3.784874603217255*^9}, {
  3.784874756260972*^9, 3.784874770806426*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"42b8edaf-b577-429a-8ba5-0e6af9419e86"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tracks", "Subsection",
 CellChangeTimes->{{3.664706146097403*^9, 3.664706150233775*^9}, {
  3.782629554662147*^9, 
  3.782629555657982*^9}},ExpressionUUID->"e90df646-fcda-4e76-95a1-\
097a6dc8a726"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sample1Tracks", "=", 
   RowBox[{"Import", "[", "\"\<../test-data/sample-1/tracks.wdx\>\"", "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"sample2Tracks", "=", 
   RowBox[{"Import", "[", "\"\<../test-data/sample-2/tracks.wdx\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sample3Tracks", "=", 
   RowBox[{"Import", "[", "\"\<../test-data/sample-3/tracks.wdx\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tracks", "=", 
   RowBox[{"{", 
    RowBox[{"sample1Tracks", ",", "sample2Tracks", ",", "sample3Tracks"}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.782629567855661*^9, 3.782629596587901*^9}, {
  3.782629668185948*^9, 3.782629687101055*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"7598cbce-75e8-4617-b849-70516c56c850"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Colors", "Subsection",
 CellChangeTimes->{{3.664714887001225*^9, 
  3.664714887887388*^9}},ExpressionUUID->"8bf4a371-0a2a-4091-8622-\
4544c2d5461d"],

Cell[BoxData[
 RowBox[{"colors", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ColorData", "[", 
     RowBox[{"109", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"14", ",", "13", ",", "15"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.6749836323390408`*^9, 3.674983678101206*^9}, {
  3.6749858421671267`*^9, 3.674985843620822*^9}, {3.676010570043435*^9, 
  3.676010570177293*^9}, {3.6760106120175657`*^9, 3.676010612192692*^9}, {
  3.6762852976303997`*^9, 3.676285297796936*^9}, {3.676285515477705*^9, 
  3.676285515571837*^9}, {3.678688731870427*^9, 3.678688755744474*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"0598c0cf-6f7f-4b0b-aeb6-ee6a1b34e5d8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cell counts", "Section",
 CellChangeTimes->{{3.664785146139381*^9, 
  3.6647851482182283`*^9}},ExpressionUUID->"4ea636c0-c4c7-41e7-8872-\
ad683b2f9bf9"],

Cell[CellGroupData[{

Cell["Absolute cell counts", "Subsection",
 CellChangeTimes->{{3.664794232832479*^9, 
  3.6647942368015213`*^9}},ExpressionUUID->"8d391161-7ed6-4571-9b4c-\
57d24ebd8cfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"counts", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Length", ",", "cellPositions", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664865944805612*^9, 3.6648659477541122`*^9}, {
  3.784875013040257*^9, 3.784875023370696*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"f9511c72-0fa9-457e-b467-db67047de61c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"counts", ",", 
    RowBox[{"Total", "/@", "counts"}]}], "}"}], "//", "Dimensions"}]], "Input",\

 CellChangeTimes->{{3.6648825713742847`*^9, 3.664882572553684*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"913634d1-ce54-41d0-a920-4c111ed7e05a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relative cell counts", "Subsection",
 CellChangeTimes->{{3.664866236436473*^9, 
  3.66486624020562*^9}},ExpressionUUID->"dd966327-5f1f-4826-8e1b-\
ba8adb7cb8b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"totals", "=", 
   RowBox[{"Total", "/@", "counts"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relatives", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "/", 
        RowBox[{"totals", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "&"}], "/@", 
      RowBox[{"counts", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "counts"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.6648673453572083`*^9, 3.664867348283633*^9}, {
   3.664867412796397*^9, 3.6648674284024878`*^9}, {3.664867479042973*^9, 
   3.664867629857233*^9}, {3.664867671200697*^9, 3.664867683550192*^9}, 
   3.678514951133388*^9},
 CellLabel->
  "In[373]:=",ExpressionUUID->"a6d1847e-7a52-4bcd-8517-171af16965bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ConfidencePlot", ",", 
    RowBox[{"BaseStyle", "->", 
     RowBox[{"{", 
      RowBox[{"8", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "}"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ticks", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"EvenQ", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "i", ",", 
        RowBox[{"{", 
         RowBox[{".01", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "\"\<\>\"", ",", 
        RowBox[{"{", 
         RowBox[{".005", ",", "0"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "5", ",", "12"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6797179712199078`*^9, 3.679717994084457*^9}, {
   3.679718062065798*^9, 3.679718091904953*^9}, {3.6797181797103233`*^9, 
   3.679718190806142*^9}, {3.679718445074761*^9, 3.6797184495052958`*^9}, {
   3.6797185163327*^9, 3.679718530490612*^9}, 3.679718570744452*^9, {
   3.6797186066958733`*^9, 3.679718643708688*^9}, {3.6797186765464582`*^9, 
   3.6797186860088177`*^9}, {3.6797187202949047`*^9, 3.679718802543345*^9}},
 CellLabel->
  "In[376]:=",ExpressionUUID->"688778f2-32f9-4402-805c-f0e532bc33ff"],

Cell[BoxData[
 RowBox[{"first", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ConfidencePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", "#1"}], ",", 
         RowBox[{"Color", "\[Rule]", "#2"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4.", ",", "12.5"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"DataRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "18"}], "}"}]}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"4.", ",", "0"}], "}"}]}]}], "]"}], "&"}], ",", 
      RowBox[{"Most", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Transpose", "[", "relatives", "]"}], ",", "colors"}], 
        "}"}]}]}], "]"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "4"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", ".5", ",", "1."}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.680933948129208*^9, 3.6809339496563053`*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"732dece1-2fe5-4c1a-a2d0-316ff4ba9429"],

Cell[BoxData[
 RowBox[{"last", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConfidencePlot", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "105"}], "]"}], "&"}], "/@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"Color", "\[Rule]", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"LineStyle", "\[Rule]", "Dashed"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"4.", ",", "7.5"}], "}"}]}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"4.", ",", "0"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ConfidencePlot", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "105"}], "]"}], "&"}], "/@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"Color", "\[Rule]", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"7.5", ",", "12.5"}], "}"}]}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"4.", ",", "0"}], "}"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}],
     "&"}], "@", 
   RowBox[{"(", 
    RowBox[{"Last", "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "[", "relatives", "]"}], ",", "colors"}], "}"}]}],
     ")"}]}]}]], "Input",
 CellChangeTimes->{{3.680933966149776*^9, 3.680934091172423*^9}, {
  3.680934147980358*^9, 3.680934149444964*^9}, {3.680934320943653*^9, 
  3.680934334463026*^9}, {3.6809345910685062`*^9, 3.680934605634232*^9}, {
  3.680934767127367*^9, 3.680934809206411*^9}, {3.680934875312498*^9, 
  3.680934890411057*^9}, {3.680935038740571*^9, 3.680935043876053*^9}, {
  3.680935092952455*^9, 3.680935122335644*^9}, {3.680935383170857*^9, 
  3.6809354244659157`*^9}, {3.680935465991211*^9, 3.680935491677909*^9}, {
  3.680935523384659*^9, 3.680935564529567*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"14701a26-d48a-4b84-9195-5630f8f7cede"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gr", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"first", ",", "last"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.680935584608757*^9, 3.6809355879285994`*^9}, {
  3.680935624878059*^9, 3.6809356288044*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"b12914eb-7a77-47b3-b4cf-5979176d601d"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<../results/relative_cell_counts+1,96*standard_error.pdf\>\"", ",", 
   "gr"}], "]"}]], "Input",
 CellChangeTimes->{{3.680935644322564*^9, 3.680935671377391*^9}, {
   3.78262997150565*^9, 3.7826299745352087`*^9}, 3.784875061036991*^9},
 CellLabel->
  "In[382]:=",ExpressionUUID->"6979426c-f21d-41c0-8dd6-d77d074775af"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Mean", "/@", 
    RowBox[{"Transpose", "@", "relatives"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "colors"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4.", ",", "12.5"}], "}"}], ",", "All"}], "}"}]}], ",", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"4", ",", "18"}], "}"}]}], ",", 
   RowBox[{"AxesOrigin", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"4.", ",", "0"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6802544087766323`*^9, 3.6802544235119867`*^9}},
 CellLabel->
  "In[383]:=",ExpressionUUID->"1e79705a-7947-469d-a693-7978a4f37c31"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../results/relative-cell_counts.pdf\>\"", ",", 
   RowBox[{"Show", "[", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ConfidencePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", "#1"}], ",", 
         RowBox[{"Color", "\[Rule]", "#2"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", "All"}], "}"}]}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "[", "relatives", "]"}], ",", "colors"}], 
       "}"}]}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.664867698578401*^9, 3.664867730408485*^9}, {
  3.679647634519043*^9, 3.6796476685429993`*^9}, {3.782630018178811*^9, 
  3.78263002051369*^9}},
 CellLabel->
  "In[385]:=",ExpressionUUID->"baf01606-8c68-443a-9f1b-6d2ce2c1f304"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radii", "Section",
 CellChangeTimes->{{3.6648710676178207`*^9, 
  3.664871068360579*^9}},ExpressionUUID->"4c0c9817-325e-4449-8126-\
bd9f51316a2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"radii", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "@", "#"}], "&"}], ",", "cellPositions", ",", 
     RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664871094363689*^9, 3.664871141381175*^9}, {
  3.784553962986498*^9, 3.784553967255365*^9}, {3.784875075275969*^9, 
  3.784875093472845*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"9dced16b-d27a-4046-a6eb-6f9b82ae7903"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sample1Mean", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Mean", ",", 
     RowBox[{"radii", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6797193746856003`*^9, 3.679719378191619*^9}, {
  3.78263010095325*^9, 3.782630101812599*^9}},
 CellLabel->
  "In[388]:=",ExpressionUUID->"61373be4-bc10-4296-890d-aa89e9e4ae6a"],

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"StandardDeviationPlot", "[", 
     RowBox[{
      RowBox[{"#1", "/", 
       RowBox[{"sample1Mean", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"Color", "\[Rule]", "#2"}], ",", 
      RowBox[{"DataRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"4", ",", "18"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4.", ",", "12.5"}], "}"}], ",", "All"}], "}"}]}]}], "]"}], 
    "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"radii", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "colors"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.782630114575406*^9, 3.782630118577149*^9}},
 CellLabel->
  "In[390]:=",ExpressionUUID->"af785bfd-6f75-490d-a43e-e2f8d548a76c"],

Cell[BoxData[
 RowBox[{"first", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StandardDeviationPlot", "[", 
        RowBox[{
         RowBox[{"#1", "/", 
          RowBox[{"sample1Mean", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"Color", "\[Rule]", "#2"}], ",", 
         RowBox[{"DataRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "18"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4.", ",", "12.5"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"DeviationScaling", "\[Rule]", ".3"}]}], "]"}], "&"}], ",", 
      RowBox[{"Most", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"radii", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "colors"}], "}"}]}]}], "]"}], 
    ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "4"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680936252219921*^9, 3.680936430602994*^9}, {
  3.680937368689282*^9, 3.680937372207868*^9}, {3.6809374554240303`*^9, 
  3.680937475250805*^9}, {3.680937517531343*^9, 3.680937525009554*^9}, {
  3.782630127288967*^9, 3.782630129021678*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"e0eb63d7-54af-4998-80b0-4c4609c11d90"],

Cell[BoxData[
 RowBox[{"last", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StandardDeviationPlot", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"sample1Mean", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "105"}], "]"}], ")"}], 
          ",", 
          RowBox[{"Color", "\[Rule]", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"LineStyle", "\[Rule]", "Dashed"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"4.", ",", "7.5"}], "}"}]}], ",", 
          RowBox[{"DeviationScaling", "\[Rule]", "0"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StandardDeviationPlot", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"sample1Mean", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "105"}], "]"}], ")"}], 
          ",", 
          RowBox[{"Color", "\[Rule]", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"7.5", ",", "12.5"}], "}"}]}], ",", 
          RowBox[{"DeviationScaling", "\[Rule]", ".3"}]}], "]"}]}], "}"}], 
      ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}],
     "&"}], "@", 
   RowBox[{"(", 
    RowBox[{"Last", "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"radii", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "colors"}], "}"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.680937563934099*^9, 3.680937707127775*^9}, {
  3.6809379309800158`*^9, 3.680937937142017*^9}, {3.680937970998189*^9, 
  3.680938006177411*^9}, {3.78263015035256*^9, 3.7826301564392757`*^9}},
 CellLabel->
  "In[392]:=",ExpressionUUID->"d42d2aee-8c9b-4b32-a68d-245a92da4e5c"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../results/radii+scaled-standard_deviation.pdf\>\"", ",", 
   RowBox[{"Show", "[", 
    RowBox[{"first", ",", "last"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6809380116944923`*^9, 3.680938017790833*^9}, {
  3.680938145101692*^9, 3.680938196955638*^9}, {3.782630163180566*^9, 
  3.782630167131884*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"28d37669-0e03-4932-abcf-6b5797824771"],

Cell[CellGroupData[{

Cell["Population radii", "Subsection",
 CellChangeTimes->{{3.6652347143476467`*^9, 
  3.665234722622595*^9}},ExpressionUUID->"401efe0e-c133-4cab-881e-\
1a26c9b9a212"],

Cell[BoxData[
 RowBox[{
  RowBox[{"means", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Mean", ",", "radii", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.665234724732605*^9, 3.665234751664267*^9}, {
  3.665234838047956*^9, 3.665234845615552*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"9708345f-2257-4035-a5dd-f3e7446bc25e"],

Cell[BoxData[
 RowBox[{"means", "//", "Dimensions"}]], "Input",
 CellChangeTimes->{{3.679650050266608*^9, 3.679650111133767*^9}, {
  3.679650154054717*^9, 3.679650219253251*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"41e67e57-8ece-4b91-a463-015fa99c552e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"normalization", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"means", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2", ",", "i"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "420"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.679650225976468*^9, 3.679650274666546*^9}, 
   3.679718964202797*^9},
 CellLabel->
  "In[396]:=",ExpressionUUID->"0346c380-e5f8-440b-8885-53495382b2c0"],

Cell[BoxData[
 RowBox[{"gr", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "@", "#1"}], "/", "#3"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "#2"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         RowBox[{"DataRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "18"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4.", ",", "12.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{".9", ",", "1.1"}], "}"}]}], "}"}]}]}], "]"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "@", "means"}], ",", "colors", ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"normalization", ",", "3"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"AxesOrigin", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"4.", ",", ".9"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "4"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", 
       RowBox[{"{", 
        RowBox[{".9", ",", "1.", ",", "1.1"}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzk0ow3EAxvGRhBz4Jy+3Sa1ZGeHgYIkmppAlxQHzUjJjltm85OXPFPPS
DlO2llpzVdqyNReTUl4imbAwRmZb3mZZDvJ/foenz+mpb3bHgLg7lsVisZnB
DEdTz0NdsFzHNcshbRKoYOhXRrTtcudgz10+8Vqv0sIEc/0izNSv6GEkT7IK
v/bL1qF40EA0KGkr/NvmOWGvyP0cYJSbPQE4LDX3t/UGy08LNAOwpLBLCatv
y0bg48X7BKTq4ydhTO0ZDTOHjzRw7+1kGS7JPcRj99Ie+Wt/iB0W7wGcL3Yd
Qt6R1A1f3pJvoDDxyQ+//Zux7Yz+rYVUONTIpWBS1FkKC19FAsge4wthVvVV
JQxFuDWwglpogFHxbB/8HNITOfJ7BaT5IeKUhFLBgG1GDVMibB00KGeJOapk
I4xzCEwwV91sgemjixvwQ2v1djLu2Kt80M5RBGCRTBqGvJbBs2n0VY2fw5BM
cUmsEPngWthF0YytRmUa/AfTDgrZ
  "],
 CellLabel->
  "In[397]:=",ExpressionUUID->"5293b77a-227b-4366-a45d-62f893760f01"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../results/radii_long2.pdf\>\"", ",", "gr"}], "]"}]], "Input",
 CellChangeTimes->{{3.665234997983849*^9, 3.665235015679405*^9}, {
  3.679650492766223*^9, 3.679650499340713*^9}, {3.679657950942313*^9, 
  3.679657953166033*^9}, {3.6797192051688433`*^9, 3.67971922217635*^9}, {
  3.679719783408024*^9, 3.679719792205175*^9}, {3.7826306602822323`*^9, 
  3.782630660548543*^9}, {3.78487523881248*^9, 3.784875240186418*^9}},
 CellLabel->
  "In[398]:=",ExpressionUUID->"a1a762c9-3cd5-48c4-ac26-5dc456ff84fc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["cell tracks and straightness index", "Section",
 CellChangeTimes->{{3.7826313611269197`*^9, 
  3.782631370164215*^9}},ExpressionUUID->"80b975e3-7cb1-4f50-8efb-\
6b787b5de374"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "select", " ", "tracklets", " ", "from", " ", "time", " ", "interval"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"selectTrack", ",", "selectTracks"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selectTracks", "[", 
     RowBox[{
      RowBox[{"tracks", ":", 
       RowBox[{"{", "__Rule", "}"}]}], ",", "start_Integer", ",", 
      "end_Integer"}], "]"}], ":=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"selectTrack", "[", 
         RowBox[{"#", ",", "start", ",", "end"}], "]"}], "&"}], "/@", 
       "tracks"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selectTrack", "[", 
     RowBox[{"track_Rule", ",", "start_Integer", ",", "end_Integer"}], "]"}], 
    ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"First", "@", "track"}], "<", "start"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Last", "@", "track"}]}], "<", 
         RowBox[{"(", 
          RowBox[{"start", "-", 
           RowBox[{"First", "@", "track"}], "+", "1"}], ")"}]}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Last", "@", "track"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "-", 
             RowBox[{"First", "@", "track"}], "+", "1"}], ",", 
            RowBox[{"UpTo", "[", 
             RowBox[{"end", "-", 
              RowBox[{"First", "@", "track"}], "+", "1"}], "]"}]}], "}"}]}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"Last", "@", "track"}], ",", 
        RowBox[{"UpTo", "[", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"end", "-", 
            RowBox[{"First", "@", "track"}], "+", "1"}]}], "]"}], "]"}]}], 
       "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.676803921235661*^9, 3.676804019899913*^9}, {
   3.6768040645361013`*^9, 3.6768040996577063`*^9}, {3.676804137243627*^9, 
   3.6768041374034147`*^9}, {3.6768041720670967`*^9, 3.676804217682341*^9}, {
   3.676804254041645*^9, 3.676804300638349*^9}, {3.676804343350779*^9, 
   3.6768043436533833`*^9}, {3.6768044064109497`*^9, 3.676804406674734*^9}, {
   3.67680451410221*^9, 3.676804563404541*^9}, {3.676804622028124*^9, 
   3.6768046880215*^9}, {3.676805027015684*^9, 3.6768051269094152`*^9}, {
   3.676805887135304*^9, 3.676805941884419*^9}, {3.676967926638668*^9, 
   3.676967937429598*^9}, 3.679224952881114*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"751bec0d-3ebb-4b4a-886a-4ef3bb756512"],

Cell[BoxData[
 RowBox[{"<<", "ColorBrewer`"}]], "Input",
 CellChangeTimes->{{3.782638949395318*^9, 3.7826389594151363`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"fdca8fad-1cd3-401b-8848-0d144d87533a"],

Cell[CellGroupData[{

Cell["tracks ", "Subsubsection",
 CellChangeTimes->{{3.679403252777863*^9, 3.679403257417831*^9}, {
  3.680933179478874*^9, 
  3.68093319729956*^9}},ExpressionUUID->"965ce0b1-5cbc-4f79-8c40-\
ee1841ae3649"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tracklets", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"selectTracks", "[", 
          RowBox[{"#", ",", "50", ",", "90"}], "]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"Length", "@", "x"}], "<", "10"}]}]}], "]"}], ",", 
       RowBox[{"x_", "/;", 
        RowBox[{"AnyTrue", "[", 
         RowBox[{
          RowBox[{"Norm", "/@", 
           RowBox[{"Differences", "@", "x"}]}], ",", 
          RowBox[{
           RowBox[{"#", ">", "50"}], "&"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
    "sample1Tracks"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.679298556732904*^9, 3.679298561555566*^9}, {
   3.6792988881860847`*^9, 3.679298888368333*^9}, {3.679299424175359*^9, 
   3.679299424455091*^9}, {3.6792995930651817`*^9, 3.679299598087571*^9}, {
   3.6792996811886253`*^9, 3.679299683420356*^9}, {3.6793881297403183`*^9, 
   3.679388129842958*^9}, {3.6793882987449503`*^9, 3.6793883771132593`*^9}, {
   3.67938891838076*^9, 3.679388942835476*^9}, {3.6793890198487997`*^9, 
   3.6793890203906593`*^9}, {3.6793890886331797`*^9, 3.679389089846146*^9}, {
   3.6796623491457243`*^9, 3.67966235154419*^9}, {3.679733490097673*^9, 
   3.679733496199945*^9}, 3.679733756301593*^9, {3.680491126679262*^9, 
   3.6804911268271017`*^9}, {3.7826390750452957`*^9, 3.782639076504732*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"101485db-b37f-4ee4-9c79-a371a1ad5e38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"end", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "@", 
          RowBox[{"First", "@", 
           RowBox[{"Differences", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}]}]}], "/", 
         RowBox[{"(", 
          RowBox[{"Total", "[", 
           RowBox[{"Norm", "/@", 
            RowBox[{"Differences", "@", "#"}]}], "]"}], ")"}]}], "&"}], ",", 
       "#"}], "]"}], "&"}], "/@", "tracklets"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6793879835421667`*^9, 3.679388065589644*^9}, 
   3.679388948971551*^9, {3.6797335779678297`*^9, 3.679733588433981*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"fac3a874-23b7-4cc2-83c5-7b89bde06a69"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "testTrackVis", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testTrackVis", "[", 
   RowBox[{"brewName_", ",", 
    RowBox[{"n_:", "9"}], ",", 
    RowBox[{"inverted_:", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"brewfun", ",", "mesPlot", ",", "ectPlot"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"brewfun", "=", 
      RowBox[{"CreateColorFunction", "[", 
       RowBox[{"brewName", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mesPlot", "=", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"brewfun", "[", 
              RowBox[{"If", "[", 
               RowBox[{"inverted", ",", 
                RowBox[{"1", "-", "#1"}], ",", "#1"}], "]"}], "]"}], ",", 
             RowBox[{"Line", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"mesoLUT", ",", "mesotracks"}], "}"}]}], "]"}], ",", 
        RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], ";", 
     RowBox[{"ectPlot", "=", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"brewfun", "[", 
              RowBox[{"If", "[", 
               RowBox[{"inverted", ",", 
                RowBox[{"1", "-", "#1"}], ",", "#1"}], "]"}], "]"}], ",", 
             RowBox[{"Line", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"ectoLUT", ",", "ectotracks"}], "}"}]}], "]"}], ",", 
        RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"mesPlot", ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Front"}]}], "]"}], ",", 
          RowBox[{"Show", "[", 
           RowBox[{"mesPlot", ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Top"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"ectPlot", ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Front"}]}], "]"}], ",", 
          RowBox[{"Show", "[", 
           RowBox[{"ectPlot", ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Top"}]}], "]"}]}], "}"}]}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"caec2789-4010-422b-a4ac-aa4d5dfde21f"],

Cell[BoxData[
 RowBox[{"sphere", "=", 
  RowBox[{"SphericalPlot3D", "[", 
   RowBox[{"245", ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phi", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "None"}], ",", 
    RowBox[{"Mesh", "\[Rule]", "7"}], ",", 
    RowBox[{"MeshStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", "Gray"}], "]"}]}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.682835548591599*^9, 3.6828357337318077`*^9}, {
  3.6828357674671497`*^9, 3.6828357917547617`*^9}, {3.682835842403059*^9, 
  3.682835878171171*^9}, {3.682835913555645*^9, 3.6828359288723*^9}, {
  3.68283645024494*^9, 3.6828364626115932`*^9}, {3.682872901923354*^9, 
  3.68287296644291*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"4382dffd-b7ca-4f39-ae02-b541b18cc232"],

Cell[BoxData[
 RowBox[{
  RowBox[{"brewfun", "=", 
   RowBox[{"CreateColorFunction", "[", 
    RowBox[{"Spectral", ",", "9"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6828376180595703`*^9, 3.682837627042893*^9}, {
  3.682837657275371*^9, 3.682837657978668*^9}, {3.682837696284463*^9, 
  3.682837696986652*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"b16864f9-6207-4ff7-9a0e-b80ada550e60"],

Cell[BoxData[
 RowBox[{"mesPlotFront", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
           RowBox[{"brewfun", "[", "#1", "]"}], ",", 
           RowBox[{"Line", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"end", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"tracklets", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "Infinity"}], ",", "0"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", "sphere", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "300"}], "}"}], ",", "All"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682835272396187*^9, 3.682835287554748*^9}, {
   3.682835340699987*^9, 3.682835384771739*^9}, {3.6828354176758347`*^9, 
   3.682835417850569*^9}, {3.682835678060166*^9, 3.682835682050867*^9}, {
   3.682835966172484*^9, 3.682835975906994*^9}, {3.682836073827929*^9, 
   3.682836074330695*^9}, 3.682836169435918*^9, {3.68283694534877*^9, 
   3.682836959338915*^9}, {3.682837051949004*^9, 3.6828370527642717`*^9}, {
   3.6828376153160133`*^9, 3.6828376300915127`*^9}, {3.761376388053887*^9, 
   3.7613763881204653`*^9}, {3.7826390001399183`*^9, 3.782639000317876*^9}, {
   3.7826438456772337`*^9, 3.782643869277652*^9}, {3.782644094657078*^9, 
   3.782644094794566*^9}, {3.782644405557876*^9, 3.782644405782132*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"22366955-9391-422d-8bcc-2beb04a43184"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../results/mesoPlotFront.pdf\>\"", ",", "mesPlotFront"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.761376403828291*^9, 3.761376408712545*^9}, {
  3.782639006882944*^9, 
  3.782639008417574*^9}},ExpressionUUID->"93b011ba-8eea-4b92-8772-\
8a5739eaa33c"],

Cell[BoxData[
 RowBox[{"mesPlotTop", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
           RowBox[{"brewfun", "[", "#1", "]"}], ",", 
           RowBox[{"Line", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"end", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"tracklets", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", "sphere", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "300"}], "}"}], ",", "All"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682835947212594*^9, 3.6828359609221363`*^9}, {
   3.682836083539563*^9, 3.68283608381879*^9}, 3.682836173555419*^9, {
   3.682836966445099*^9, 3.682836969339757*^9}, {3.682837056140255*^9, 
   3.6828370569079723`*^9}, {3.682837639836402*^9, 3.682837640483094*^9}, 
   3.782643936546968*^9, {3.7826440372891006`*^9, 3.782644083547817*^9}, {
   3.782644412178029*^9, 3.7826444224944963`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"5322b29d-eeb2-4496-bd8c-fda7b99b0029"],

Cell[BoxData[
 RowBox[{"ectPlotFront", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
           RowBox[{"brewfun", "[", "#1", "]"}], ",", 
           RowBox[{"Line", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"end", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"tracklets", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "Infinity"}], ",", "0"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", "sphere", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "300"}], "}"}], ",", "All"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682835272396187*^9, 3.682835287554748*^9}, {
   3.682835340699987*^9, 3.682835384771739*^9}, {3.6828354176758347`*^9, 
   3.682835417850569*^9}, {3.682835678060166*^9, 3.682835682050867*^9}, {
   3.682835966172484*^9, 3.682835975906994*^9}, {3.682836073827929*^9, 
   3.682836123804522*^9}, 3.682836154548272*^9, {3.682836974484189*^9, 
   3.6828369776834593`*^9}, {3.6828370595719357`*^9, 3.682837060393313*^9}, 
   3.6828376473400793`*^9, {3.761376274556972*^9, 3.761376295401307*^9}, {
   3.78263903715228*^9, 3.782639037297144*^9}, {3.782643943195447*^9, 
   3.782643945684256*^9}, {3.782644111151142*^9, 3.782644111310088*^9}, {
   3.7826444178624573`*^9, 3.7826444187210608`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"728c7486-679a-4e42-95db-51e003619423"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../results/ectoPlotFront.pdf\>\"", ",", "ectPlotFront"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7613763005393467`*^9, 3.76137633837584*^9}, {
  3.7826390257930393`*^9, 
  3.782639027690633*^9}},ExpressionUUID->"f0627496-4762-4d41-864d-\
c3268a7c615b"],

Cell[BoxData[
 RowBox[{"ectPlotTop", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
           RowBox[{"brewfun", "[", "#1", "]"}], ",", 
           RowBox[{"Line", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"end", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"tracklets", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", "sphere", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "300"}], "}"}], ",", "All"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682835947212594*^9, 3.6828359609221363`*^9}, {
   3.682836083539563*^9, 3.682836113842662*^9}, 3.682836162571558*^9, {
   3.682836981211369*^9, 3.682836985569874*^9}, {3.682837063485063*^9, 
   3.682837064233141*^9}, 3.6828376515473347`*^9, {3.782643958723423*^9, 
   3.782643962887991*^9}, {3.782644122897251*^9, 3.782644138209203*^9}, {
   3.7826444306561604`*^9, 3.782644430954825*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"84ea9f45-5ac1-4389-9d74-71bd2ab75677"],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"CreateColorFunction", "[", 
        RowBox[{"Spectral", ",", "11"}], "]"}], "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "/", "9"}], "]"}], ",", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "9"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.68283737089427*^9, 3.682837528771215*^9}, {
  3.6828377396287394`*^9, 
  3.6828377422352552`*^9}},ExpressionUUID->"d2a65647-2b68-4f8b-8160-\
45737cd642a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotationMatrix", "=", 
   RowBox[{
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Pi", "/", "2.4"}], "+", ".1"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "Pi"}], "/", "3.2"}], "-", ".1"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{"-", ".2"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{
  3.6792990883701468`*^9, {3.7826314740931*^9, 3.7826314765128517`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"55007a8b-7eb0-4169-9307-a0e2114c68f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sample1Tracks", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "rotationMatrix"}], "&"}], "/@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "&"}], ",", 
     "sample1Tracks", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67929909237612*^9, 3.679299175027966*^9}, {
  3.6792992218147173`*^9, 3.679299224638376*^9}, {3.679662357655664*^9, 
  3.67966235878412*^9}, {3.782631507411186*^9, 3.782631517150035*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"086ce602-7af0-4c66-aa5c-79738dec1a57"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Correlation analysis", "Subsubsection",
 CellChangeTimes->{{3.680491149342341*^9, 
  3.680491154094063*^9}},ExpressionUUID->"70ee834c-a4cf-4d66-a871-\
f23732b43138"],

Cell[BoxData[
 RowBox[{"colors", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ColorData", "[", 
     RowBox[{"109", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"14", ",", "13", ",", "15"}], "}"}]}]}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"a244d160-0636-4ec6-be9c-e6bc612a6d2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"spherical", "=", 
   RowBox[{"Transpose", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToSpherical", "[", 
        RowBox[{"Last", "@", "#"}], "]"}], "&"}], ",", "tracklets", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.680491221321741*^9, 3.680491328631042*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"de176d1a-9faa-4ad9-844d-64e854869d9c"],

Cell[BoxData[
 RowBox[{"ecto", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"end", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"colors", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"spherical", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]], "Input",
 CellLabel->"In[45]:=",ExpressionUUID->"1e09d761-ad7a-44d6-8018-f85dc7342d43"],

Cell[BoxData[
 RowBox[{"meso", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"end", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"colors", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"spherical", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.680491441682331*^9, 3.6804914689246683`*^9}, {
  3.680491504621482*^9, 3.680491509860053*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"f0c8bc88-a95d-4db9-b76d-412b440232e9"],

Cell[BoxData[
 RowBox[{"gr", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"#1", ",", "#2", ",", 
       RowBox[{"PlotRange", "\[Rule]", "#3"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", "#4"}]}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"ecto", ",", "meso", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "Automatic"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], ",", 
            RowBox[{"Pi", "/", "2"}]}], "}"}], ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "Pi"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Pi"}], "/", "2"}], ",", "0"}], "}"}], ",", 
        "Automatic"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680491518033103*^9, 3.680491538722652*^9}, {
  3.680491599012236*^9, 3.680491683449562*^9}, {3.680491791604651*^9, 
  3.68049184281104*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"64a4c29a-6945-4dc5-bf00-4d8b29ef7a78"],

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\<../results/\>\"", "<>", "#1", "<>", "\"\<-correlation.pdf\>\""}], 
      ",", "#2"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<latitude\>\"", ",", "\"\<longitude\>\"", ",", "\"\<radius\>\""}], 
      "}"}], ",", "gr"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.680491860017017*^9, 3.680491878399349*^9}, {
  3.680491938504668*^9, 3.680491970918859*^9}, {3.680492013288569*^9, 
  3.6804920286551456`*^9}, {3.7826391210442266`*^9, 3.7826391239308233`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"3da41fb8-d2fd-4748-b21f-913e1ba109c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpearmanRho", "[", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"end", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"spherical", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6804917081687307`*^9, 3.680491758726528*^9}, {
  3.6804924438169127`*^9, 
  3.680492446336104*^9}},ExpressionUUID->"83303a41-5617-40b6-9f01-\
9b28215739e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpearmanRho", "[", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"end", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"spherical", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680491774924799*^9, 3.68049177962747*^9}, {
  3.680492449360613*^9, 
  3.6804924509524183`*^9}},ExpressionUUID->"9bb3d003-8439-44bf-997c-\
525042a8e5db"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{129, Automatic}, {23, Automatic}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 826, 15, 73, "Input",ExpressionUUID->"b63ba021-b85d-45b0-ad55-3dcdfefbd11c"],
Cell[CellGroupData[{
Cell[1409, 39, 155, 3, 67, "Section",ExpressionUUID->"b027ae07-e0de-45be-a8ee-222be405f984"],
Cell[CellGroupData[{
Cell[1589, 46, 159, 3, 54, "Subsection",ExpressionUUID->"5c3bc57c-6381-4c44-a4c2-5e3c84c1cb93"],
Cell[1751, 51, 758, 17, 94, "Input",ExpressionUUID->"2007e4d1-9919-4240-80f7-a4a4834975c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2546, 73, 219, 4, 54, "Subsection",ExpressionUUID->"45375a06-0300-4f18-af04-66e6bfe2635a"],
Cell[2768, 79, 355, 9, 30, "Input",ExpressionUUID->"357f5151-602c-40f2-b575-e5d434a62eb6"],
Cell[3126, 90, 708, 19, 73, "Input",ExpressionUUID->"960e0049-2f51-4726-b436-d857ec7ce69c"],
Cell[3837, 111, 672, 18, 73, "Input",ExpressionUUID->"59b3fc95-31ec-49ab-9468-c8c8fb98f5fa"],
Cell[4512, 131, 1266, 38, 73, "Input",ExpressionUUID->"09f5ec6a-6b75-4709-bf58-1af5d91af2de"],
Cell[5781, 171, 1002, 28, 73, "Input",ExpressionUUID->"8153c0fd-f6fc-453d-a04c-6d22a9520a76"],
Cell[6786, 201, 382, 9, 30, "Input",ExpressionUUID->"42b8edaf-b577-429a-8ba5-0e6af9419e86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7205, 215, 203, 4, 54, "Subsection",ExpressionUUID->"e90df646-fcda-4e76-95a1-097a6dc8a726"],
Cell[7411, 221, 818, 20, 94, "Input",ExpressionUUID->"7598cbce-75e8-4617-b849-70516c56c850"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8266, 246, 154, 3, 54, "Subsection",ExpressionUUID->"8bf4a371-0a2a-4091-8622-4544c2d5461d"],
Cell[8423, 251, 666, 13, 30, "Input",ExpressionUUID->"0598c0cf-6f7f-4b0b-aeb6-ee6a1b34e5d8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9138, 270, 158, 3, 67, "Section",ExpressionUUID->"4ea636c0-c4c7-41e7-8872-ad683b2f9bf9"],
Cell[CellGroupData[{
Cell[9321, 277, 170, 3, 54, "Subsection",ExpressionUUID->"8d391161-7ed6-4571-9b4c-57d24ebd8cfc"],
Cell[9494, 282, 381, 9, 30, "Input",ExpressionUUID->"f9511c72-0fa9-457e-b467-db67047de61c"],
Cell[9878, 293, 299, 8, 30, "Input",ExpressionUUID->"913634d1-ce54-41d0-a920-4c111ed7e05a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10214, 306, 167, 3, 54, "Subsection",ExpressionUUID->"dd966327-5f1f-4826-8e1b-ba8adb7cb8b1"],
Cell[10384, 311, 881, 24, 52, "Input",ExpressionUUID->"a6d1847e-7a52-4bcd-8517-171af16965bc"],
Cell[11268, 337, 1330, 32, 52, "Input",ExpressionUUID->"688778f2-32f9-4402-805c-f0e532bc33ff"],
Cell[12601, 371, 1327, 37, 115, "Input",ExpressionUUID->"732dece1-2fe5-4c1a-a2d0-316ff4ba9429"],
Cell[13931, 410, 2639, 65, 136, "Input",ExpressionUUID->"14701a26-d48a-4b84-9195-5630f8f7cede"],
Cell[16573, 477, 330, 8, 30, "Input",ExpressionUUID->"b12914eb-7a77-47b3-b4cf-5979176d601d"],
Cell[16906, 487, 374, 8, 30, "Input",ExpressionUUID->"6979426c-f21d-41c0-8dd6-d77d074775af"],
Cell[17283, 497, 714, 19, 52, "Input",ExpressionUUID->"1e79705a-7947-469d-a693-7978a4f37c31"],
Cell[18000, 518, 884, 22, 73, "Input",ExpressionUUID->"baf01606-8c68-443a-9f1b-6d2ce2c1f304"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18933, 546, 152, 3, 67, "Section",ExpressionUUID->"4c0c9817-325e-4449-8126-bd9f51316a2a"],
Cell[19088, 551, 473, 12, 30, "Input",ExpressionUUID->"9dced16b-d27a-4046-a6eb-6f9b82ae7903"],
Cell[19564, 565, 433, 11, 30, "Input",ExpressionUUID->"61373be4-bc10-4296-890d-aa89e9e4ae6a"],
Cell[20000, 578, 875, 26, 73, "Input",ExpressionUUID->"af785bfd-6f75-490d-a43e-e2f8d548a76c"],
Cell[20878, 606, 1375, 35, 115, "Input",ExpressionUUID->"e0eb63d7-54af-4998-80b0-4c4609c11d90"],
Cell[22256, 643, 2268, 60, 136, "Input",ExpressionUUID->"d42d2aee-8c9b-4b32-a68d-245a92da4e5c"],
Cell[24527, 705, 448, 9, 30, "Input",ExpressionUUID->"28d37669-0e03-4932-abcf-6b5797824771"],
Cell[CellGroupData[{
Cell[25000, 718, 166, 3, 54, "Subsection",ExpressionUUID->"401efe0e-c133-4cab-881e-1a26c9b9a212"],
Cell[25169, 723, 368, 9, 30, "Input",ExpressionUUID->"9708345f-2257-4035-a5dd-f3e7446bc25e"],
Cell[25540, 734, 261, 5, 30, "Input",ExpressionUUID->"41e67e57-8ece-4b91-a463-015fa99c552e"],
Cell[25804, 741, 547, 15, 30, "Input",ExpressionUUID->"0346c380-e5f8-440b-8885-53495382b2c0"],
Cell[26354, 758, 2011, 52, 136, "Input",ExpressionUUID->"5293b77a-227b-4366-a45d-62f893760f01"],
Cell[28368, 812, 555, 9, 30, "Input",ExpressionUUID->"a1a762c9-3cd5-48c4-ac26-5dc456ff84fc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28972, 827, 181, 3, 67, "Section",ExpressionUUID->"80b975e3-7cb1-4f50-8efb-6b787b5de374"],
Cell[29156, 832, 2784, 71, 178, "Input",ExpressionUUID->"751bec0d-3ebb-4b4a-886a-4ef3bb756512"],
Cell[31943, 905, 203, 3, 30, "Input",ExpressionUUID->"fdca8fad-1cd3-401b-8848-0d144d87533a"],
Cell[CellGroupData[{
Cell[32171, 912, 206, 4, 45, "Subsubsection",ExpressionUUID->"965ce0b1-5cbc-4f79-8c40-ee1841ae3649"],
Cell[32380, 918, 1526, 32, 73, "Input",ExpressionUUID->"101485db-b37f-4ee4-9c79-a371a1ad5e38"],
Cell[33909, 952, 897, 24, 52, "Input",ExpressionUUID->"fac3a874-23b7-4cc2-83c5-7b89bde06a69"],
Cell[34809, 978, 2681, 69, 220, "Input",ExpressionUUID->"caec2789-4010-422b-a4ac-aa4d5dfde21f"],
Cell[37493, 1049, 926, 20, 52, "Input",ExpressionUUID->"4382dffd-b7ca-4f39-ae02-b541b18cc232"],
Cell[38422, 1071, 397, 8, 30, "Input",ExpressionUUID->"b16864f9-6207-4ff7-9a0e-b80ada550e60"],
Cell[38822, 1081, 1928, 42, 94, "Input",ExpressionUUID->"22366955-9391-422d-8bcc-2beb04a43184"],
Cell[40753, 1125, 306, 7, 30, "Input",ExpressionUUID->"93b011ba-8eea-4b92-8772-8a5739eaa33c"],
Cell[41062, 1134, 1579, 37, 94, "Input",ExpressionUUID->"5322b29d-eeb2-4496-bd8c-fda7b99b0029"],
Cell[42644, 1173, 1902, 42, 94, "Input",ExpressionUUID->"728c7486-679a-4e42-95db-51e003619423"],
Cell[44549, 1217, 309, 7, 30, "Input",ExpressionUUID->"f0627496-4762-4d41-864d-c3268a7c615b"],
Cell[44861, 1226, 1578, 37, 94, "Input",ExpressionUUID->"84ea9f45-5ac1-4389-9d74-71bd2ab75677"],
Cell[46442, 1265, 831, 24, 73, "Input",ExpressionUUID->"d2a65647-2b68-4f8b-8160-45737cd642a9"],
Cell[47276, 1291, 855, 25, 52, "Input",ExpressionUUID->"55007a8b-7eb0-4169-9307-a0e2114c68f4"],
Cell[48134, 1318, 787, 20, 30, "Input",ExpressionUUID->"086ce602-7af0-4c66-aa5c-79738dec1a57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48958, 1343, 171, 3, 45, "Subsubsection",ExpressionUUID->"70ee834c-a4cf-4d66-a871-f23732b43138"],
Cell[49132, 1348, 304, 8, 30, "Input",ExpressionUUID->"a244d160-0636-4ec6-be9c-e6bc612a6d2b"],
Cell[49439, 1358, 453, 11, 30, "Input",ExpressionUUID->"de176d1a-9faa-4ad9-844d-64e854869d9c"],
Cell[49895, 1371, 609, 17, 30, "Input",ExpressionUUID->"1e09d761-ad7a-44d6-8018-f85dc7342d43"],
Cell[50507, 1390, 726, 19, 30, "Input",ExpressionUUID->"f0c8bc88-a95d-4db9-b76d-412b440232e9"],
Cell[51236, 1411, 1442, 41, 73, "Input",ExpressionUUID->"64a4c29a-6945-4dc5-bf00-4d8b29ef7a78"],
Cell[52681, 1454, 727, 18, 52, "Input",ExpressionUUID->"3da41fb8-d2fd-4748-b21f-913e1ba109c9"],
Cell[53411, 1474, 496, 14, 30, "Input",ExpressionUUID->"83303a41-5617-40b6-9f01-9b28215739e2"],
Cell[53910, 1490, 493, 14, 30, "Input",ExpressionUUID->"9bb3d003-8439-44bf-997c-525042a8e5db"]
}, Open  ]]
}, Open  ]]
}
]
*)

