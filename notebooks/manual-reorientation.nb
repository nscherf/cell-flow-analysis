(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45685,       1215]
NotebookOptionsPosition[     40139,       1135]
NotebookOutlinePosition[     40476,       1150]
CellTagsIndexPosition[     40433,       1147]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"<<", "Eidomatica`"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.662983405661673*^9, 3.662983415372918*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"1ef39c6c-a13f-4f3c-a046-6cf50b6d84e7"],

Cell[BoxData[
 TemplateBox[{
  "lib","nolink",
   "\"Can't find \\\"libEidomatica\\\" at \
\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/scherni/Library/Mathematica/Applications/\
Eidomatica/LibraryResources/MacOSX-x86-64/libEidomatica\\\\\\\"\\\"}]\\). \
Some functions may work.\"",2,106,16,33306277368491584437,"Local",
   "Eidomatica`Private`lib"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.782627531609118*^9},
 CellLabel->
  "During evaluation of \
In[106]:=",ExpressionUUID->"9daa1954-5844-4b6b-bbeb-65bcdd1fff6d"],

Cell[BoxData["\<\"Revisions: {Eidomatica Package: 347, libEidomatica: \
Unknown}\"\>"], "Print",
 CellChangeTimes->{3.662989378406954*^9, 3.663055692001734*^9, 
  3.663931469001182*^9, 3.6640132143419027`*^9, 3.664022555777199*^9, 
  3.664173998651326*^9, 3.664183530660377*^9, 3.664535041465376*^9, 
  3.664544932381777*^9, 3.664545007010454*^9, 3.664546374828676*^9, 
  3.664709128503055*^9, 3.664709940789867*^9, 3.664735233318668*^9, 
  3.664794707390278*^9, 3.671778405574911*^9, 3.671778471951824*^9, 
  3.6717809365511093`*^9, 3.671781225359333*^9, 3.671781319634251*^9, 
  3.671954243113493*^9, 3.671956592655188*^9, 3.78262753237477*^9},
 CellLabel->
  "During evaluation of \
In[106]:=",ExpressionUUID->"8aadc981-8294-456e-838b-82ce02c64094"],

Cell[BoxData["\<\"/Users/scherni/Dropbox/Work/projects/cell-flow-analysis/\
notebooks\"\>"], "Output",
 CellChangeTimes->{3.66298211721702*^9, 3.6629824918020287`*^9, 
  3.662989378501624*^9, 3.663055692087582*^9, 3.663931469080529*^9, 
  3.664013214450777*^9, 3.664022555879929*^9, 3.664173998721805*^9, 
  3.6641835307260237`*^9, 3.664535042056623*^9, 3.664544932684534*^9, 
  3.664545007123765*^9, 3.664546374932026*^9, 3.664709128589551*^9, 
  3.664709940868128*^9, 3.6647352347523813`*^9, 3.664794707716518*^9, 
  3.671778405649036*^9, 3.671778472274353*^9, 3.671780936655261*^9, 
  3.671781225460293*^9, 3.6717813197072353`*^9, 3.6719542432050543`*^9, 
  3.671956592748382*^9, 3.782627532409976*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"dd0096ee-ca84-41a0-a186-ce08d970c7f3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<4.611\>\"", ",", "\"\<51.22\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<96.04\>\"", ",", "\"\<50.24\>\""}], "}"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"e8a4cb6c-8d42-45bc-ac48-d84e45a7b906"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"correction", ",", "corr"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"correction", "[", 
   RowBox[{"x", ":", 
    RowBox[{"{", 
     RowBox[{"__", "?", "NumericQ"}], "}"}]}], "]"}], ":=", 
  RowBox[{"corr", "[", 
   RowBox[{"Sequence", "@@", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"corr", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"longitude", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"latitude", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"radius", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sawtooth", "[", 
        RowBox[{"longitude", ",", 
         RowBox[{"2", " ", "Pi"}], ",", "Pi"}], "]"}], ",", 
       RowBox[{"Sawtooth", "[", 
        RowBox[{"latitude", ",", "Pi", ",", 
         RowBox[{"Pi", "/", "2"}]}], "]"}], ",", "radius"}], "}"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{3.671779834622611*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"a0b4d840-184a-48a5-a8c1-9924609759c0"],

Cell["This notebook is for documentation purposes only. ", "Text",
 CellChangeTimes->{{3.782628124895046*^9, 
  3.782628170241694*^9}},ExpressionUUID->"99573cc2-2e9b-4ad5-bc8b-\
abf240fb8d3d"],

Cell[CellGroupData[{

Cell["sample 1", "Section",
 CellChangeTimes->{{3.6629822233844633`*^9, 3.66298222390338*^9}, {
  3.7826275431690702`*^9, 
  3.782627544433086*^9}},ExpressionUUID->"ee20cc57-cbe4-4970-ae20-\
e33a061ff9dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.662989369416936*^9, 
  3.6629893738152943`*^9}},ExpressionUUID->"9bacf92a-a04b-43d1-aeea-\
5c8fe16288fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", "\"\<../data/sample-1/raw.mx\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"trans", "=", 
   RowBox[{
   "Import", "[", "\"\<../data/sample-1/transformation-matrix.m\>\"", "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.662982136614953*^9, 3.662982147111187*^9}, 
   3.662982187867742*^9, 3.662982246521751*^9, 3.662982460641527*^9, {
   3.662982837558872*^9, 3.662982841407543*^9}, {3.782627550779204*^9, 
   3.782627580523098*^9}, {3.782628073856229*^9, 3.782628112037635*^9}, {
   3.7826281871024857`*^9, 
   3.782628187211166*^9}},ExpressionUUID->"4ac3506d-7c6b-4ae8-8e47-\
177f3b19b7ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"centroids", "=", 
   RowBox[{"Most", "/@", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\<../data/sample-1/centroid-positions-raw.csv\>\"", ",", 
      "\"\<Table\>\"", ",", 
      RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", " ", "\"\<,\>\""}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.662982136614953*^9, 3.662982147111187*^9}, 
   3.662982187867742*^9, 3.662982246521751*^9, 3.662982460641527*^9, {
   3.662982837558872*^9, 3.662982841407543*^9}, {3.782628086158939*^9, 
   3.7826281173246737`*^9}},ExpressionUUID->"db10a673-238e-4e11-8031-\
44beb586281b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformed", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", "#"}], "\[Rule]", 
           RowBox[{"trans", "[", 
            RowBox[{
             RowBox[{"Last", "@", "#"}], "-", 
             RowBox[{"centroids", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "420"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6629825520324183`*^9, 3.662982576558959*^9}, {
  3.662982638979643*^9, 3.662982855070369*^9}, {3.662982894230007*^9, 
  3.662982901556589*^9}, {3.66298293454918*^9, 3.662982942556081*^9}, {
  3.662988330655484*^9, 
  3.662988332581707*^9}},ExpressionUUID->"65da1360-0abb-45be-925e-\
7bdd3447245e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transform", "=", 
   RowBox[{
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "80"}], "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{"Pi", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.662988672616334*^9, 3.6629887258638573`*^9}, {
  3.662991004039115*^9, 3.662991032305118*^9}, {3.66299106935917*^9, 
  3.662991127369735*^9}},ExpressionUUID->"81ea9f39-2db7-4437-8498-\
1e9c57dec93d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformed2", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", "#"}], "\[Rule]", 
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], ".", "transform"}]}], "&"}], "/@", 
         RowBox[{"transformed", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"transformed", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"transformed", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "420"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6629887307280188`*^9, 
  3.662988780606112*^9}},ExpressionUUID->"f80def87-2087-4705-8fff-\
9a7f07203367"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../data/sample-1/data.wdx\>\"", ",", "transformed2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.662991157033592*^9, 3.662991198601016*^9}, {
  3.782628182574457*^9, 
  3.782628197997939*^9}},ExpressionUUID->"9e9fb67d-589f-4520-a36d-\
4552b31cfe74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformed", "=", 
   RowBox[{"Import", "[", "\"\<../data/sample-1/data.wdx\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6645450144819*^9, 3.6645450234008904`*^9}, {
  3.78262820025955*^9, 
  3.782628214026236*^9}},ExpressionUUID->"56cb5eaa-fbf8-4aef-8340-\
c3cd37e95ae6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Last", "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"transformed", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "100", ",", "1"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"Last", "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"transformed", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "100", ",", "1"}], "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.671778826529229*^9, 3.671778853254653*^9}, {
  3.6717789109478083`*^9, 3.671778911065382*^9}, {3.6717789730816*^9, 
  3.6717790052555*^9}, {3.671779443757454*^9, 
  3.671779446691839*^9}},ExpressionUUID->"41b5cd8a-73a7-4789-b305-\
cc17c8f7f4d4"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ToMercator", "@", 
      RowBox[{"ToSpherical", "[", 
       RowBox[{"test", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"ToMercator", "@", 
      RowBox[{"ToSpherical", "[", 
       RowBox[{"test", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671778704263489*^9, 3.671778735938137*^9}, {
  3.6717789535772753`*^9, 
  3.671778966656378*^9}},ExpressionUUID->"2a24fa27-b4b6-4794-8fba-\
3abed0598d7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ToMercator", "/@", 
        RowBox[{"ToSpherical", "/@", 
         RowBox[{"Last", "/@", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}]}]}], "&"}], "/@", 
      "transformed"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.662988409847761*^9, 3.662988478106069*^9}, {
  3.6629886388449717`*^9, 
  3.6629886395954103`*^9}},ExpressionUUID->"16d56ce2-6787-43e1-a8f0-\
c9574a841952"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"MatrixPlot", "[", 
    RowBox[{"CellDensityMatrix", "[", 
     RowBox[{"test", ",", 
      RowBox[{"PlotDimensions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"100", ",", "100"}], "}"}]}], ",", 
      RowBox[{"MapProjection", "\[Rule]", "\"\<Mercator\>\""}], ",", 
      RowBox[{"OriginalDimensions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "1000"}], "}"}]}]}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Point", "/@", "points"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.662990711510511*^9, 3.662990713242262*^9}, {
  3.662990984228109*^9, 3.662990988179875*^9}, {3.664545065061108*^9, 
  3.664545108064457*^9}},ExpressionUUID->"23f24965-b10b-408d-b5e0-\
08055a3574f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test2", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ToMercator", "@", 
        RowBox[{"ToSpherical", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", ".", "transform"}], "&"}], "/@", 
           RowBox[{"Last", "/@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], 
       "&"}], "/@", "transformed"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6629908041015387`*^9, 
  3.662990898505561*^9}},ExpressionUUID->"3bd69815-2265-4000-b748-\
c2cd3f1e6141"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "@", 
  RowBox[{"CellDensityMatrix", "[", 
   RowBox[{"test2", ",", 
    RowBox[{"PlotDimensions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"100", ",", "100"}], "}"}]}], ",", 
    RowBox[{"MapProjection", "\[Rule]", "\"\<Mercator\>\""}], ",", 
    RowBox[{"OriginalDimensions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1000", ",", "1000"}], "}"}]}], ",", 
    RowBox[{"Inset", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Red", ",", 
       RowBox[{"Point", "/@", "points"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.66298848056677*^9, 3.66298849438561*^9}, {
   3.662988541098961*^9, 3.6629885481326237`*^9}, {3.662989405590919*^9, 
   3.662989412022272*^9}, {3.6629907986508017`*^9, 3.662990800448658*^9}, 
   3.662990902015525*^9, {3.662990969277913*^9, 3.662990972324113*^9}, {
   3.6645449101985817`*^9, 
   3.6645449260718517`*^9}},ExpressionUUID->"cc6b92e4-046c-44c2-ba3c-\
49ac54328129"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Charlie", "Section",
 CellChangeTimes->{{3.663046537158058*^9, 
  3.663046538072764*^9}},ExpressionUUID->"1efede1e-6e83-4cd7-b02d-\
742081794cae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.662989369416936*^9, 
  3.6629893738152943`*^9}},ExpressionUUID->"ec42b723-5a09-4ec7-9c98-\
6d5831e62fcb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", "\"\<../data/sample-2/raw.mx\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"centroids", "=", 
   RowBox[{"Most", "/@", 
    RowBox[{"Import", "[", "\"\<../data/sample-2/centroids.mx\>\"", "]"}]}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.662982136614953*^9, 3.662982147111187*^9}, 
   3.662982187867742*^9, 3.662982246521751*^9, 3.662982460641527*^9, {
   3.662982837558872*^9, 3.662982841407543*^9}, {3.663055627370023*^9, 
   3.6630556361845922`*^9}, {3.663055667073262*^9, 3.663055709848494*^9}, {
   3.663055742672071*^9, 3.663055752111871*^9}, {3.782628227123589*^9, 
   3.782628244459923*^9}},ExpressionUUID->"33ef9495-31e0-41e7-a1ad-\
a10f3f4b1622"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformed", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", "#"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Last", "@", "#"}], "-", 
             RowBox[{"centroids", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "420"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.663055784024302*^9, 
  3.66305579757751*^9}},ExpressionUUID->"5c93af3a-f817-4e73-b9c3-\
ee129a31d63f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transF", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.9002585960432585`"}], ",", "0.09080999462925977`", ",", 
       RowBox[{"-", "0.4257792915650722`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.11502312914187582`", ",", 
       RowBox[{"-", "0.893638445715881`"}], ",", 
       RowBox[{"-", "0.43379719697217495`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.41988586545945117`"}], ",", 
       RowBox[{"-", "0.4395041219532968`"}], ",", "0.7940604427708443`"}], 
      "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.663056926404592*^9, 3.663056967660791*^9}, {
   3.6645436863588133`*^9, 3.6645437575025387`*^9}, 3.66454423016768*^9, 
   3.664709392614043*^9, 3.664794743571103*^9, 3.664796136475705*^9, 
   3.664796186186062*^9, 3.664796269529213*^9, 3.664796300780998*^9, 
   3.664796332424492*^9},ExpressionUUID->"474f4b50-4c05-41a3-bba3-\
d305ea228769"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformed2", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", "#"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Last", "[", "#", "]"}], ".", "transF"}], ")"}]}], "&"}],
          "/@", 
         RowBox[{"transformed", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"transformed", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"transformed", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "420"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.663057175826982*^9, 3.663057195430793*^9}, 
   3.664794746875174*^9},ExpressionUUID->"f1993565-1968-4893-b503-\
195de535b1a4"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../data/sample-2/data.mx\>\"", ",", "transformed2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.663057924897429*^9, 3.663057944167634*^9}, {
  3.664544239673359*^9, 3.664544241801401*^9}, {3.782628253175189*^9, 
  3.7826282554284687`*^9}},ExpressionUUID->"097165fc-6477-4ec4-9ab9-\
df5157de4897"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformed", "=", 
   RowBox[{"Import", "[", "\"\<../data/sample-2/data.mx\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6645350202826023`*^9, 3.664535064732009*^9}, 
   3.664709525750773*^9, {3.782628261356913*^9, 
   3.7826282634685783`*^9}},ExpressionUUID->"14b03825-08f6-41e2-9ea0-\
72d77ac7790d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Last", "/@", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "42"}], ",", "1"}], "]"}], "]"}]}], "&"}], "/@", 
      "transformed"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.662988409847761*^9, 3.662988478106069*^9}, {
   3.6629886388449717`*^9, 3.6629886395954103`*^9}, {3.663056809509676*^9, 
   3.6630568624436283`*^9}, 3.6630569853646317`*^9, 3.663057905866482*^9, {
   3.664709178647189*^9, 3.66470917874331*^9}, 
   3.664709528109562*^9},ExpressionUUID->"0ffcaa7b-401c-421d-b09a-\
ba5016bd2faa"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"y", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"j", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"k", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"trans", "=", 
     RowBox[{"x", ".", "y", ".", "z"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListPointPlot3D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", ".", "trans"}], "&"}], "/@", "test"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Opacity", "[", ".3", "]"}]}], "]"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.664535101016674*^9, 3.664535185906768*^9}, {
  3.6645352422932577`*^9, 3.664535245660777*^9}, {3.6645352902292433`*^9, 
  3.664535307446261*^9}, {3.664543714098989*^9, 3.664543717402397*^9}, {
  3.664543772545925*^9, 3.664543796330757*^9}, {3.664543839287757*^9, 
  3.664543889418622*^9}, {3.6645439596158943`*^9, 3.664543971175441*^9}, {
  3.664544559833168*^9, 3.664544561858027*^9}, {3.664546302149592*^9, 
  3.664546342262773*^9}},ExpressionUUID->"4d31df42-169a-485d-a70b-\
a63b893085ef"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"y", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"j", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"k", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"trans", "=", 
     RowBox[{"x", ".", "y", ".", "z"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"ToMercator", "@", 
       RowBox[{"ToSpherical", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "trans"}], "&"}], "/@", "test"}], "]"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Opacity", "[", ".3", "]"}]}], "]"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1000"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1000"}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", 
     RowBox[{"2", "Pi"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.66470914818531*^9, 3.66470919999094*^9}, {
  3.6647092919905977`*^9, 3.664709306172817*^9}, {3.664794822203979*^9, 
  3.664794826510561*^9}, {3.664796037059202*^9, 
  3.664796043936273*^9}},ExpressionUUID->"a1e2f1f4-dfbc-4501-be45-\
07310da9d2aa"],

Cell[CellGroupData[{

Cell[BoxData["trans"], "Input",
 CellChangeTimes->{{3.664709375140606*^9, 
  3.664709376546423*^9}},ExpressionUUID->"b108325e-d243-469d-961d-\
98f8c5089d65"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9002585960432585`"}], ",", "0.09080999462925977`", ",", 
     RowBox[{"-", "0.4257792915650722`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11502312914187582`", ",", 
     RowBox[{"-", "0.893638445715881`"}], ",", 
     RowBox[{"-", "0.43379719697217495`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.41988586545945117`"}], ",", 
     RowBox[{"-", "0.4395041219532968`"}], ",", "0.7940604427708443`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.664709377998323*^9, 3.664796127075211*^9, 
  3.6647961687315903`*^9, 3.6647962617730637`*^9, 3.6647962918083353`*^9, 
  3.664796325978136*^9},ExpressionUUID->"2aebcf4c-b777-4335-8aaf-\
b7a8567583f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Last", "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"transformed", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "100", ",", "1"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"Last", "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"transformed", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "100", ",", "1"}], "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.671778826529229*^9, 3.671778853254653*^9}, {
  3.6717789109478083`*^9, 3.671778911065382*^9}, {3.6717789730816*^9, 
  3.6717790052555*^9}, {3.671779443757454*^9, 
  3.671779446691839*^9}},ExpressionUUID->"dd355f0c-d75e-451b-a6dd-\
855c71ea276e"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ToMercator", "@", 
      RowBox[{"ToSpherical", "[", 
       RowBox[{"test", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"ToMercator", "@", 
      RowBox[{"ToSpherical", "[", 
       RowBox[{"test", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671778704263489*^9, 3.671778735938137*^9}, {
  3.6717789535772753`*^9, 
  3.671778966656378*^9}},ExpressionUUID->"288f09c7-657f-4cac-ae07-\
234877d0e84e"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"MatrixPlot", "@", 
    RowBox[{"CellDensityMatrix", "[", 
     RowBox[{
      RowBox[{"ToMercator", "@", 
       RowBox[{"ToSpherical", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "transF"}], "&"}], "/@", "test"}], "]"}]}], ",", 
      RowBox[{"PlotDimensions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"100", ",", "100"}], "}"}]}], ",", 
      RowBox[{"MapProjection", "\[Rule]", "\"\<Mercator\>\""}], ",", 
      RowBox[{"OriginalDimensions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "1000"}], "}"}]}]}], "]"}]}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Point", "/@", "points"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.662990711510511*^9, 3.662990713242262*^9}, {
   3.662990984228109*^9, 3.662990988179875*^9}, {3.663056997739601*^9, 
   3.663057015660033*^9}, 3.663057912234085*^9, {3.664535075316711*^9, 
   3.6645350774758253`*^9}, {3.664544075581545*^9, 3.6645440967579947`*^9}, {
   3.6645449658353367`*^9, 3.664544990374783*^9}, {3.664545141380727*^9, 
   3.664545162092554*^9}, {3.664735259807214*^9, 3.6647352600061493`*^9}, {
   3.664795027207646*^9, 
   3.6647950295063133`*^9}},ExpressionUUID->"1e2eab05-ca95-4de0-b8e7-\
0ed6a783390e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Charlotte", "Section",
 CellChangeTimes->{{3.663931347839262*^9, 
  3.663931348949991*^9}},ExpressionUUID->"076dda46-3279-4d9a-a715-\
80c38e445b4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.662989369416936*^9, 
  3.6629893738152943`*^9}},ExpressionUUID->"74243da7-ee69-4442-adb5-\
5516ce126d7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", "\"\<../data/sample-3/raw.mx\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"centroids", "=", 
   RowBox[{"Most", "/@", 
    RowBox[{"Import", "[", "\"\<../data/sample-3/centroids.mx\>\"", "]"}]}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.662982136614953*^9, 3.662982147111187*^9}, 
   3.662982187867742*^9, 3.662982246521751*^9, 3.662982460641527*^9, {
   3.662982837558872*^9, 3.662982841407543*^9}, {3.663055627370023*^9, 
   3.6630556361845922`*^9}, {3.663055667073262*^9, 3.663055709848494*^9}, {
   3.663055742672071*^9, 3.663055752111871*^9}, {3.663931376391643*^9, 
   3.663931389325719*^9}, {3.6639314209570217`*^9, 3.663931422741082*^9}, {
   3.663931457625279*^9, 3.663931463569337*^9}, {3.782628270066278*^9, 
   3.7826282781024303`*^9}},ExpressionUUID->"3f86125d-baa8-4a1b-94c2-\
ed7d0a4cbebf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformed", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", "#"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Last", "@", "#"}], "-", 
             RowBox[{"centroids", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "420"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\
ExpressionUUID->"e3c456ed-59f0-440e-bf1f-56c751d2a2fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trans", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.9029295132706673`", ",", "0.11406652419213055`", ",", 
      RowBox[{"-", "0.4143755809932842`"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.044653484369943736`", ",", "0.9340226068227104`", ",", 
      "0.3544119584293563`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.427462700593185`", ",", 
      RowBox[{"-", "0.33851233065109265`"}], ",", "0.8382631100070828`"}], 
     "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.664174804712699*^9, 3.6641749045450573`*^9}, 
   3.664546636971623*^9},ExpressionUUID->"4a386844-d130-49c5-896d-\
1e456a38e605"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.9029295132706673`", ",", "0.11406652419213055`", ",", 
     RowBox[{"-", "0.4143755809932842`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.044653484369943736`", ",", "0.9340226068227104`", ",", 
     "0.3544119584293563`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.427462700593185`", ",", 
     RowBox[{"-", "0.33851233065109265`"}], ",", "0.8382631100070828`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.664174735611389*^9, {3.6641748063907337`*^9, 3.664174854545121*^9}, {
   3.664174888006967*^9, 3.664174905002533*^9}, 
   3.664546640372884*^9},ExpressionUUID->"be891b69-29d3-498b-9be6-\
9f9b9fb4d218"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../data/sample-3/data.mx\>\"", ",", "transformed2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.664175004602757*^9, 3.664175006894433*^9}, {
  3.7826282837605247`*^9, 
  3.7826282861433887`*^9}},ExpressionUUID->"f07861ed-66ec-46ed-99b6-\
73d1d7549b79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformed", "=", 
   RowBox[{"Import", "[", "\"\<../data/sample-3/data.mx\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.664546382401544*^9, 3.664546413140028*^9}, {
  3.782628288440812*^9, 
  3.782628290041676*^9}},ExpressionUUID->"6f4b7f39-79ec-4b83-bd63-\
b5b60ac73e44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Last", "/@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}]}], "&"}], "/@", 
      "transformed"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.662988409847761*^9, 3.662988478106069*^9}, {
   3.6629886388449717`*^9, 3.6629886395954103`*^9}, {3.663056809509676*^9, 
   3.6630568624436283`*^9}, 3.6630569853646317`*^9, 3.663057905866482*^9, {
   3.664013828206122*^9, 3.664013992188526*^9}, {3.664014084479169*^9, 
   3.664014088221314*^9}, {3.664174935057314*^9, 3.664174943593398*^9}, {
   3.664544331545988*^9, 3.664544332201548*^9}, {3.67178125357635*^9, 
   3.6717812537754183`*^9}},ExpressionUUID->"2e1a7504-7848-4fc2-a55f-\
49c5be547a76"],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "test"}]], "Input",
 CellChangeTimes->{{3.671781258958392*^9, 
  3.671781261855246*^9}},ExpressionUUID->"01bae94f-f361-4be6-8dda-\
cecb1385c5d6"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"y", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"j", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"k", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"trans", "=", 
     RowBox[{"x", ".", "y", ".", "z"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListPointPlot3D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", ".", "trans"}], "&"}], "/@", "test"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Opacity", "[", ".3", "]"}]}], "]"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "Pi"}], ",", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "Pi"}], ",", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "Pi"}], ",", 
     RowBox[{"2", "Pi"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.664535101016674*^9, 3.664535185906768*^9}, {
  3.6645352422932577`*^9, 3.664535245660777*^9}, {3.6645352902292433`*^9, 
  3.664535307446261*^9}, {3.664543714098989*^9, 3.664543717402397*^9}, {
  3.664543772545925*^9, 3.664543796330757*^9}, {3.664543839287757*^9, 
  3.664543889418622*^9}, {3.6645439596158943`*^9, 3.664543971175441*^9}, {
  3.664544559833168*^9, 3.664544561858027*^9}, {3.664546433254569*^9, 
  3.664546463860434*^9}},ExpressionUUID->"b2ca3ab1-3a7a-42ed-b210-\
276dd3f4c75b"],

Cell[CellGroupData[{

Cell[BoxData["trans"], "Input",
 CellChangeTimes->{{3.6645465780838947`*^9, 
  3.664546578756784*^9}},ExpressionUUID->"31e0c6b2-b564-4262-998e-\
c43521ddefe1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.9029295132706673`", ",", "0.11406652419213055`", ",", 
     RowBox[{"-", "0.4143755809932842`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.044653484369943736`", ",", "0.9340226068227104`", ",", 
     "0.3544119584293563`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.427462700593185`", ",", 
     RowBox[{"-", "0.33851233065109265`"}], ",", "0.8382631100070828`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.664546579437601*^9, 
  3.6645466114673643`*^9},ExpressionUUID->"c48af20c-50c3-401f-b06c-\
57d0026b0142"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Last", "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"transformed", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "100", ",", "1"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"Last", "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"transformed", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "100", ",", "1"}], "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.671778826529229*^9, 3.671778853254653*^9}, {
  3.6717789109478083`*^9, 3.671778911065382*^9}, {3.6717789730816*^9, 
  3.6717790052555*^9}, {3.671779443757454*^9, 
  3.671779446691839*^9}},ExpressionUUID->"d0ac8d64-6ac2-43fe-a921-\
a52d23a20a14"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ToMercator", "@", 
      RowBox[{"ToSpherical", "[", 
       RowBox[{"test", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"ToMercator", "@", 
      RowBox[{"ToSpherical", "[", 
       RowBox[{"test", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671778704263489*^9, 3.671778735938137*^9}, {
  3.6717789535772753`*^9, 
  3.671778966656378*^9}},ExpressionUUID->"f0d9bede-c73d-4843-a9c4-\
7242bb0abe84"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"MatrixPlot", "@", 
    RowBox[{"CellDensityMatrix", "[", 
     RowBox[{
      RowBox[{"ToMercator", "@", 
       RowBox[{"ToSpherical", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "trans"}], "&"}], "/@", "test"}], "]"}]}], ",", 
      RowBox[{"PlotDimensions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"100", ",", "100"}], "}"}]}], ",", 
      RowBox[{"MapProjection", "\[Rule]", "\"\<Mercator\>\""}], ",", 
      RowBox[{"OriginalDimensions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "1000"}], "}"}]}]}], "]"}]}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Point", "/@", "points"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.662990711510511*^9, 3.662990713242262*^9}, {
   3.662990984228109*^9, 3.662990988179875*^9}, {3.663056997739601*^9, 
   3.663057015660033*^9}, 3.663057912234085*^9, {3.664174096740336*^9, 
   3.664174109393395*^9}, 
   3.664545324761643*^9},ExpressionUUID->"d733cfd8-10e6-4522-85b1-\
48a70e50a4dc"]
}, Open  ]]
},
WindowSize->{1065, 855},
WindowMargins->{{26, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 311, 6, 52, "Input",ExpressionUUID->"1ef39c6c-a13f-4f3c-a046-6cf50b6d84e7"],
Cell[894, 30, 532, 12, 24, "Message",ExpressionUUID->"9daa1954-5844-4b6b-bbeb-65bcdd1fff6d"],
Cell[1429, 44, 752, 12, 24, "Print",ExpressionUUID->"8aadc981-8294-456e-838b-82ce02c64094"],
Cell[2184, 58, 788, 12, 34, "Output",ExpressionUUID->"dd0096ee-ca84-41a0-a186-ce08d970c7f3"]
}, Open  ]],
Cell[2987, 73, 402, 12, 30, "Input",ExpressionUUID->"e8a4cb6c-8d42-45bc-ac48-d84e45a7b906"],
Cell[3392, 87, 1159, 33, 94, "Input",ExpressionUUID->"a0b4d840-184a-48a5-a8c1-9924609759c0"],
Cell[4554, 122, 192, 3, 35, "Text",ExpressionUUID->"99573cc2-2e9b-4ad5-bc8b-abf240fb8d3d"],
Cell[CellGroupData[{
Cell[4771, 129, 205, 4, 67, "Section",ExpressionUUID->"ee20cc57-cbe4-4970-ae20-e33a061ff9dc"],
Cell[4979, 135, 208, 5, 30, "Input",ExpressionUUID->"9bacf92a-a04b-43d1-aeea-5c8fe16288fe"],
Cell[5190, 142, 677, 16, 52, "Input",ExpressionUUID->"4ac3506d-7c6b-4ae8-8e47-177f3b19b7ef"],
Cell[5870, 160, 618, 14, 30, "Input",ExpressionUUID->"db10a673-238e-4e11-8031-44beb586281b"],
Cell[6491, 176, 1346, 36, 73, "Input",ExpressionUUID->"65da1360-0abb-45be-925e-7bdd3447245e"],
Cell[7840, 214, 643, 18, 30, "Input",ExpressionUUID->"81ea9f39-2db7-4437-8498-1e9c57dec93d"],
Cell[8486, 234, 1064, 30, 73, "Input",ExpressionUUID->"f80def87-2087-4705-8fff-9a7f07203367"],
Cell[9553, 266, 303, 7, 30, "Input",ExpressionUUID->"9e9fb67d-589f-4520-a36d-4552b31cfe74"],
Cell[9859, 275, 320, 8, 30, "Input",ExpressionUUID->"56cb5eaa-fbf8-4aef-8340-c3cd37e95ae6"],
Cell[10182, 285, 744, 20, 30, "Input",ExpressionUUID->"41b5cd8a-73a7-4789-b305-cc17c8f7f4d4"],
Cell[10929, 307, 799, 23, 30, "Input",ExpressionUUID->"2a24fa27-b4b6-4794-8fba-3abed0598d7f"],
Cell[11731, 332, 670, 20, 30, "Input",ExpressionUUID->"16d56ce2-6787-43e1-a8f0-c9574a841952"],
Cell[12404, 354, 840, 20, 52, "Input",ExpressionUUID->"23f24965-b10b-408d-b5e0-08055a3574f7"],
Cell[13247, 376, 759, 23, 30, "Input",ExpressionUUID->"3bd69815-2265-4000-b748-c2cd3f1e6141"],
Cell[14009, 401, 955, 21, 52, "Input",ExpressionUUID->"cc6b92e4-046c-44c2-ba3c-49ac54328129"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15001, 427, 152, 3, 67, "Section",ExpressionUUID->"1efede1e-6e83-4cd7-b02d-742081794cae"],
Cell[15156, 432, 208, 5, 30, "Input",ExpressionUUID->"ec42b723-5a09-4ec7-9c98-6d5831e62fcb"],
Cell[15367, 439, 741, 16, 52, "Input",ExpressionUUID->"33ef9495-31e0-41e7-a1ad-a10f3f4b1622"],
Cell[16111, 457, 1142, 33, 52, "Input",ExpressionUUID->"5c93af3a-f817-4e73-b9c3-ee129a31d63f"],
Cell[17256, 492, 994, 23, 73, "Input",ExpressionUUID->"474f4b50-4c05-41a3-bba3-d305ea228769"],
Cell[18253, 517, 1126, 32, 73, "Input",ExpressionUUID->"f1993565-1968-4893-b503-195de535b1a4"],
Cell[19382, 551, 350, 7, 30, "Input",ExpressionUUID->"097165fc-6477-4ec4-9ab9-df5157de4897"],
Cell[19735, 560, 348, 8, 30, "Input",ExpressionUUID->"14b03825-08f6-41e2-9ea0-72d77ac7790d"],
Cell[20086, 570, 754, 20, 30, "Input",ExpressionUUID->"0ffcaa7b-401c-421d-b09a-ba5016bd2faa"],
Cell[20843, 592, 2074, 52, 178, "Input",ExpressionUUID->"4d31df42-169a-485d-a70b-a63b893085ef"],
Cell[22920, 646, 2088, 57, 199, "Input",ExpressionUUID->"a1e2f1f4-dfbc-4501-be45-07310da9d2aa"],
Cell[CellGroupData[{
Cell[25033, 707, 157, 3, 30, "Input",ExpressionUUID->"b108325e-d243-469d-961d-98f8c5089d65"],
Cell[25193, 712, 777, 19, 34, "Output",ExpressionUUID->"2aebcf4c-b777-4335-8aaf-b7a8567583f5"]
}, Open  ]],
Cell[25985, 734, 744, 20, 30, "Input",ExpressionUUID->"dd355f0c-d75e-451b-a6dd-855c71ea276e"],
Cell[26732, 756, 799, 23, 30, "Input",ExpressionUUID->"288f09c7-657f-4cac-ae07-234877d0e84e"],
Cell[27534, 781, 1335, 30, 52, "Input",ExpressionUUID->"1e2eab05-ca95-4de0-b8e7-0ed6a783390e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28906, 816, 154, 3, 67, "Section",ExpressionUUID->"076dda46-3279-4d9a-a715-80c38e445b4b"],
Cell[29063, 821, 208, 5, 30, "Input",ExpressionUUID->"74243da7-ee69-4442-adb5-5516ce126d7a"],
Cell[29274, 828, 891, 18, 52, "Input",ExpressionUUID->"3f86125d-baa8-4a1b-94c2-ed7d0a4cbebf"],
Cell[30168, 848, 1072, 30, 52, "Input",ExpressionUUID->"e3c456ed-59f0-440e-bf1f-56c751d2a2fd"],
Cell[CellGroupData[{
Cell[31265, 882, 672, 17, 73, "Input",ExpressionUUID->"4a386844-d130-49c5-896d-1e456a38e605"],
Cell[31940, 901, 709, 18, 34, "Output",ExpressionUUID->"be891b69-29d3-498b-9be6-9f9b9fb4d218"]
}, Open  ]],
Cell[32664, 922, 306, 7, 30, "Input",ExpressionUUID->"f07861ed-66ec-46ed-99b6-73d1d7549b79"],
Cell[32973, 931, 320, 8, 30, "Input",ExpressionUUID->"6f4b7f39-79ec-4b83-bd63-b5b60ac73e44"],
Cell[33296, 941, 964, 23, 30, "Input",ExpressionUUID->"2e1a7504-7848-4fc2-a55f-49c5be547a76"],
Cell[34263, 966, 187, 4, 30, "Input",ExpressionUUID->"01bae94f-f361-4be6-8dda-cecb1385c5d6"],
Cell[34453, 972, 2206, 58, 178, "Input",ExpressionUUID->"b2ca3ab1-3a7a-42ed-b210-276dd3f4c75b"],
Cell[CellGroupData[{
Cell[36684, 1034, 159, 3, 30, "Input",ExpressionUUID->"31e0c6b2-b564-4262-998e-c43521ddefe1"],
Cell[36846, 1039, 609, 16, 34, "Output",ExpressionUUID->"c48af20c-50c3-401f-b06c-57d0026b0142"]
}, Open  ]],
Cell[37470, 1058, 744, 20, 30, "Input",ExpressionUUID->"d0ac8d64-6ac2-43fe-a921-a52d23a20a14"],
Cell[38217, 1080, 799, 23, 30, "Input",ExpressionUUID->"f0d9bede-c73d-4843-a9c4-7242bb0abe84"],
Cell[39019, 1105, 1104, 27, 52, "Input",ExpressionUUID->"d733cfd8-10e6-4522-85b1-48a70e50a4dc"]
}, Open  ]]
}
]
*)

