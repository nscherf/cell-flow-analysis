(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     99434,       2467]
NotebookOptionsPosition[     90895,       2339]
NotebookOutlinePosition[     91286,       2356]
CellTagsIndexPosition[     91243,       2353]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "Eidomatica`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.656408015683893*^9, 3.6564080175889187`*^9}, {
   3.656658465976006*^9, 3.656658475361671*^9}, {3.656678958137349*^9, 
   3.656678963633894*^9}, {3.656679786831828*^9, 3.656679787185676*^9}, {
   3.663898099007929*^9, 3.6638981034679117`*^9}, {3.664886328414156*^9, 
   3.664886333066451*^9}, {3.674879302267021*^9, 3.674879303669796*^9}, {
   3.679717752403764*^9, 3.679717773766089*^9}, {3.679741784989903*^9, 
   3.679741786075618*^9}, 3.78263067193643*^9, 3.784447104695137*^9},
 CellLabel->"In[90]:=",ExpressionUUID->"b63ba021-b85d-45b0-ad55-3dcdfefbd11c"],

Cell[CellGroupData[{

Cell["Import data", "Section",
 CellChangeTimes->{{3.66470613128232*^9, 
  3.664706132946227*^9}},ExpressionUUID->"b027ae07-e0de-45be-a8ee-\
222be405f984"],

Cell[CellGroupData[{

Cell["Directories", "Subsection",
 CellChangeTimes->{{3.664706280966886*^9, 
  3.664706282494669*^9}},ExpressionUUID->"5c3bc57c-6381-4c44-a4c2-\
5e3c84c1cb93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sample1", "=", "\"\<../results/sample-1/plots/\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.664706234130728*^9, 3.66470627644689*^9}, {
  3.664706505223824*^9, 3.664706529048523*^9}, {3.6647942076047497`*^9, 
  3.664794217050798*^9}, {3.782629411270833*^9, 3.782629477711748*^9}, {
  3.784282057471772*^9, 3.784282059790868*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"2007e4d1-9919-4240-80f7-a4a4834975c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cell Position Data", "Subsection",
 CellChangeTimes->{{3.6647061405621758`*^9, 3.6647061428659983`*^9}, {
  3.782629546048731*^9, 
  3.782629552067387*^9}},ExpressionUUID->"45375a06-0300-4f18-af04-\
66e6bfe2635a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", "\"\<../test-data/sample-1/data.wdx\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655966895079336*^9, 3.655966917188788*^9}, {
   3.656045671827573*^9, 3.656045673880468*^9}, {3.657451394631624*^9, 
   3.657451394845674*^9}, {3.657619170728424*^9, 3.657619179453869*^9}, {
   3.6630581583111687`*^9, 3.6630581988542347`*^9}, 3.663898180090231*^9, {
   3.664604533804592*^9, 3.6646045557973146`*^9}, {3.6647061235277147`*^9, 
   3.6647061278986263`*^9}, {3.664706168467037*^9, 3.6647061695692883`*^9}, {
   3.6647062058165283`*^9, 3.664706213896449*^9}, {3.6647135501491957`*^9, 
   3.6647135623888206`*^9}, {3.782629484467112*^9, 3.782629542127241*^9}, {
   3.784282069421935*^9, 3.784282072807095*^9}, {3.784293565868471*^9, 
   3.784293567262405*^9}, 3.7842947793643513`*^9, {3.784447115262823*^9, 
   3.7844471167407923`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"bb7ff7d3-e996-4157-81c4-7c12f8b44f6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tracks", "Subsection",
 CellChangeTimes->{{3.664706146097403*^9, 3.664706150233775*^9}, {
  3.782629554662147*^9, 
  3.782629555657982*^9}},ExpressionUUID->"e90df646-fcda-4e76-95a1-\
097a6dc8a726"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sample1Tracks", "=", 
   RowBox[{"Import", "[", "\"\<../test-data/sample-1/tracks.wdx\>\"", "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"sample2Tracks", "=", 
   RowBox[{"Import", "[", "\"\<../test-data/sample-2/tracks.wdx\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sample3Tracks", "=", 
   RowBox[{"Import", "[", "\"\<../test-data/sample-3/tracks.wdx\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tracks", "=", 
   RowBox[{"{", 
    RowBox[{"sample1Tracks", ",", "sample2Tracks", ",", "sample3Tracks"}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.782629567855661*^9, 3.782629596587901*^9}, {
  3.782629668185948*^9, 3.782629687101055*^9}, {3.784282080914671*^9, 
  3.78428208504331*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7598cbce-75e8-4617-b849-70516c56c850"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Colors", "Subsection",
 CellChangeTimes->{{3.664714887001225*^9, 
  3.664714887887388*^9}},ExpressionUUID->"8bf4a371-0a2a-4091-8622-\
4544c2d5461d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ColorData", "[", 
      RowBox[{"109", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"14", ",", "13", ",", "15"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6749836323390408`*^9, 3.674983678101206*^9}, {
   3.6749858421671267`*^9, 3.674985843620822*^9}, {3.676010570043435*^9, 
   3.676010570177293*^9}, {3.6760106120175657`*^9, 3.676010612192692*^9}, {
   3.6762852976303997`*^9, 3.676285297796936*^9}, {3.676285515477705*^9, 
   3.676285515571837*^9}, {3.678688731870427*^9, 3.678688755744474*^9}, 
   3.7844472628371887`*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"0598c0cf-6f7f-4b0b-aeb6-ee6a1b34e5d8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Streamlines", "Section",
 CellChangeTimes->{{3.664712962002252*^9, 
  3.66471297165324*^9}},ExpressionUUID->"3933406c-be1b-4618-8fde-\
27cc791625f0"],

Cell[CellGroupData[{

Cell["Single embryo streamlines", "Subsection",
 CellChangeTimes->{{3.664712975189329*^9, 3.664712979893114*^9}, {
  3.6894946788742313`*^9, 
  3.689494684602888*^9}},ExpressionUUID->"8762112d-92e9-40b5-98f1-\
1e8eb827c2a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "createMercatorTracks", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createMercatorTracks", "[", "tracks_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", ",", "mercatorTracks"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", "#"}], "->", 
          RowBox[{"ToMercator", "@", 
           RowBox[{"ToSpherical", "[", 
            RowBox[{"Normalize", "/@", 
             RowBox[{"Last", "@", "#"}]}], "]"}]}]}], "&"}], ",", "tracks", 
        ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mercatorTracks", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Last", "@", "#"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "@", "#"}], ",", 
                 RowBox[{
                  RowBox[{"First", "@", "#"}], "+", 
                  RowBox[{"Length", "@", 
                   RowBox[{"Last", "@", "#"}]}], "-", "1"}]}], "}"}]}], 
              "]"}]}], "}"}], "]"}]}], "&"}], ",", "tmp", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
     RowBox[{"mercatorTracks", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_", ",", "t_"}], "}"}], "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"0.01", ",", "x"}], "]"}], ",", "999.99"}], "]"}], 
             ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"0.01", ",", "y"}], "]"}], ",", "999.99"}], "]"}], 
             ",", "t"}], "}"}]}]}], "&"}], ",", "mercatorTracks", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.661144295473453*^9, 3.66114438437991*^9}, {
   3.661144491072197*^9, 3.661144493367573*^9}, {3.661146956571928*^9, 
   3.6611469996539583`*^9}, {3.66116435189212*^9, 3.661164352488976*^9}, {
   3.661754188094445*^9, 3.661754189540679*^9}, {3.661755543842567*^9, 
   3.661755561820207*^9}, {3.661766321196604*^9, 3.661766343830594*^9}, {
   3.6617664542733297`*^9, 3.661766468932611*^9}, {3.661778996168564*^9, 
   3.66177900204154*^9}, {3.66178092959237*^9, 3.661780934715633*^9}, 
   3.661781081539034*^9, {3.66289382355331*^9, 3.662893838583358*^9}, {
   3.6628943591608467`*^9, 3.6628943716794243`*^9}, {3.664714075615086*^9, 
   3.6647141347518578`*^9}, 3.680346685774955*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"e8d54abb-8ba7-4cc8-9cc8-48cbd5eff9b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mercatorTracks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"createMercatorTracks", "[", "#", "]"}], "&"}], "/@", 
    "tracks"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664714141976862*^9, 3.6647141583639927`*^9}, {
   3.6647142163391438`*^9, 3.6647142174908533`*^9}, {3.664775179128978*^9, 
   3.664775182470851*^9}, {3.664775236792466*^9, 3.664775237445137*^9}, {
   3.6647753606025963`*^9, 3.664775361790783*^9}, {3.6647757973298683`*^9, 
   3.664775800760165*^9}, 3.784282123508655*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"bc825aeb-2306-4db2-9129-50b953e44b61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timeResolution", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spatialResolution", "=", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"germLayers", "=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"early", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"late", "=", "420"}], ";", "\[IndentingNewLine]", 
        RowBox[{"step", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"late", "-", "early"}], ")"}], "/", 
          RowBox[{"(", "timeResolution", ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eSpatioTemporalSeparation", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Round", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "early", ",", 
              RowBox[{"late", "-", "step"}], ",", "step"}], "}"}]}], "]"}], 
          ",", "spatialResolution", ",", 
          RowBox[{"Round", "@", "step"}], ",", 
          RowBox[{"{", 
           RowBox[{"1000", ",", "1000"}], "}"}], ",", 
          RowBox[{"CoordinateOrigin", "\[Rule]", "\"\<Mercator\>\""}], ",", 
          RowBox[{"OriginalDimensions", "\[Rule]", "  ", 
           RowBox[{"{", 
            RowBox[{"1000", ",", "1000"}], "}"}]}], ",", 
          RowBox[{"Radius", "\[Rule]", "  ", "1"}]}], "]"}]}], 
       "\[IndentingNewLine]", ")"}], "&"}], ",", "mercatorTracks", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.664714237155774*^9, 3.6647142871470747`*^9}, {
  3.672025128982423*^9, 3.6720251473871727`*^9}, {3.6720252300757732`*^9, 
  3.672025238474266*^9}, {3.686389197440906*^9, 3.6863891979751987`*^9}, {
  3.686460483502699*^9, 3.686460483614853*^9}, {3.687841373506583*^9, 
  3.687841377991826*^9}, {3.689494694820141*^9, 3.689494698049159*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"db01598d-124c-466f-86f0-abebcb9a8881"],

Cell[BoxData[
 RowBox[{
  RowBox[{"averageFields", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eComputeAverageField", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ReplaceMissing", "\[Rule]", "False"}], ",", 
        RowBox[{"ConvertToImageCS", "\[Rule]", "True"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<Mean\>\""}]}], "]"}], "&"}], ",", 
     "germLayers", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664714356031831*^9, 3.6647143700624228`*^9}, {
   3.683027272780552*^9, 3.6830272732339163`*^9}, {3.6830319619869833`*^9, 
   3.6830319627294207`*^9}, {3.6830320830169983`*^9, 3.683032083567903*^9}, {
   3.6832574371898413`*^9, 3.6832574378886213`*^9}, {3.683257860874559*^9, 
   3.683257861441373*^9}, {3.683267450262665*^9, 3.683267451010787*^9}, {
   3.686298378348971*^9, 3.686298408959662*^9}, {3.686298463981883*^9, 
   3.6862984654682493`*^9}, 3.6862985255756693`*^9, {3.6862985636064262`*^9, 
   3.686298563796736*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"37e10211-3cba-4216-8ab3-2e9623dc1e31"],

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"#2", "<>", "\"\<streams.png\>\""}], ",", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"ListStreamPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"Missing", "[", "]"}], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}]}], ",", 
              RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
              RowBox[{"StreamStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<Drop\>\"", ",", 
                 RowBox[{"colors", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"Directive", "[", "Gray", "]"}]}], ",", 
              RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "timeResolution"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "@", "#1"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"Background", "\[Rule]", "Black"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"200", "*", "timeResolution"}], ",", 
           RowBox[{"200", "*", 
            RowBox[{"Length", "@", "#1"}]}]}], "}"}]}], ",", 
        RowBox[{"Spacings", "\[Rule]", "1"}]}], "]"}]}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"averageFields", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<../results/sample-1/\>\"", ",", "\"\<../results/sample-2/\>\"", 
       ",", "\"\<../results/sample-3/\>\""}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.664777175426527*^9, 3.6647774424480867`*^9}, {
   3.6647778731082783`*^9, 3.6647779768075314`*^9}, {3.664778247973328*^9, 
   3.664778254422636*^9}, {3.664784437069479*^9, 3.664784447907146*^9}, {
   3.664870522030835*^9, 3.6648705316682777`*^9}, {3.6720252781398*^9, 
   3.6720253910220137`*^9}, {3.672026601279626*^9, 3.672026608095093*^9}, 
   3.6720266387092533`*^9, {3.6720275445649*^9, 3.672027547263462*^9}, {
   3.6720346724801197`*^9, 3.672034679051949*^9}, {3.6720394721394577`*^9, 
   3.672039479361871*^9}, 3.7842916682929688`*^9, {3.78444809297643*^9, 
   3.784448117320969*^9}, {3.7844500257440453`*^9, 3.784450027656983*^9}, {
   3.784459195916424*^9, 
   3.784459200217102*^9}},ExpressionUUID->"d5ce461b-7cab-4cb5-96ad-\
9907dd643c63"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Population mean", "Subsection",
 CellChangeTimes->{{3.66478067417491*^9, 
  3.664780677549748*^9}},ExpressionUUID->"90556789-4baa-4ee2-8a32-\
158d1aa849e1"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PartitionList", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartitionList", "[", 
   RowBox[{
    RowBox[{"list", ":", 
     RowBox[{"{", "__", "}"}]}], ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "list"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartitionList", "[", 
   RowBox[{
    RowBox[{"list", ":", 
     RowBox[{"{", "__", "}"}]}], ",", 
    RowBox[{"indices", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "spans", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"spans", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "@", "#"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "&"}], "/@", 
           RowBox[{"Rest", "@", "#"}]}]}], "]"}], "&"}], "@", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", "indices", ",", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}]}], "]"}], ",", "2", ",", "1"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ";;", 
            RowBox[{"Last", "@", "#"}]}], "]"}], "]"}], "&"}], "/@", 
        "spans"}], ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{"Length", "@", "x"}], "<", "2"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.653567985235146*^9, 3.6535681402026167`*^9}, {
  3.653568253766857*^9, 3.6535682734961147`*^9}, {3.683029117232545*^9, 
  3.683029150041583*^9}, {3.6830292142227297`*^9, 3.6830292154756613`*^9}, {
  3.683029548455106*^9, 3.683029550149485*^9}, {3.6830298739184017`*^9, 
  3.6830298930288973`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"4a133c6e-0fbe-4002-affb-a0bbef930f1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"popMean", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"DeleteMissing", "@", "#"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"Mean", "[", "_", "]"}], "\[Rule]", 
        RowBox[{"Missing", "[", "]"}]}]}], "&"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"averageFields", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}],
      ",", 
     RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.66478068448025*^9, 3.6647807154771338`*^9}, {
   3.6647807891802588`*^9, 3.664780801273436*^9}, {3.664780899675972*^9, 
   3.664780906323861*^9}, 3.664782167912155*^9, {3.664782199671876*^9, 
   3.664782202646269*^9}, 3.6647822361630993`*^9, {3.683032007795888*^9, 
   3.683032024886392*^9}, {3.683032096576092*^9, 3.683032097034524*^9}, 
   3.683032181467099*^9, {3.683257455168972*^9, 3.6832574684119587`*^9}, {
   3.683257525471752*^9, 3.683257584340886*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"33dcf3da-9fbb-4ad9-889e-b4c5db0f14f2"],

Cell[CellGroupData[{

Cell["Population mean vector visualizations", "Subsubsection",
 CellChangeTimes->{{3.689666000650489*^9, 3.689666008130252*^9}, {
  3.689667209441927*^9, 
  3.689667211414358*^9}},ExpressionUUID->"fe63e949-b643-434a-8414-\
818e4a6a0eda"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "arrowScaling", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrowScaling", "[", 
   RowBox[{
    RowBox[{"arrows", ":", 
     RowBox[{"{", "__Arrow", "}"}]}], ",", 
    RowBox[{"normalizedDensity", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"__", "?", "NumericQ"}], "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"arrowScaling", "[", 
     RowBox[{"#", ",", "normalizedDensity"}], "]"}], "&"}], "/@", 
   "arrows"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrowScaling", "[", 
   RowBox[{"arrow_Arrow", ",", 
    RowBox[{"normalizedDensity", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"__", "?", "NumericQ"}], "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"start", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"First", "@", "arrow"}]}], "\[LessEqual]", " ", "5"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Nothing", "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", "x"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "normalizedDensity", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"start", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"First", "@", "#"}], ",", "y"}], "]"}]}], "]"}], ",", 
            
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Last", "@", "#"}], ",", "x"}], "]"}]}], "]"}]}], 
           "}"}], "&"}], "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"y", "-", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"Last", "@", "#"}], "]"}]}], ",", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"First", "@", "#"}], "]"}]}], "}"}]}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", "arrow"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"#", "/", "120"}], ",", 
            RowBox[{"1", "/", "120"}]}], "]"}], "]"}], ",", 
         RowBox[{"Arrowheads", "[", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"#", "/", "60"}], ",", 
            RowBox[{"1", "/", "60"}]}], "]"}], "]"}], ",", "arrow"}], "}"}], 
       "&"}], "@", 
      RowBox[{"normalizedDensity", "[", 
       RowBox[{"[", 
        RowBox[{"Sequence", "@@", "start"}], "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.663313436339806*^9, 3.66331347625869*^9}, {
   3.6633135243281527`*^9, 3.663313731843328*^9}, {3.663313844764265*^9, 
   3.663313883714465*^9}, {3.663314665896615*^9, 3.6633147269043427`*^9}, {
   3.66331512383965*^9, 3.663315128855399*^9}, {3.663315175049*^9, 
   3.663315230287149*^9}, {3.6633152631747437`*^9, 3.663315292045487*^9}, 
   3.6633153726912117`*^9, {3.663315460167347*^9, 3.6633154647980843`*^9}, {
   3.663315588946267*^9, 3.663315589088057*^9}, {3.6633156430610332`*^9, 
   3.663315643243826*^9}, {3.663315750981813*^9, 3.663315783220642*^9}, {
   3.6633159034482183`*^9, 3.663315904006999*^9}, {3.6633160662828207`*^9, 
   3.663316095910555*^9}, {3.6633161352908363`*^9, 3.663316150123028*^9}, {
   3.663316198154334*^9, 3.663316201922171*^9}, {3.663316448029497*^9, 
   3.663316454382041*^9}, {3.663316518123633*^9, 3.663316528948003*^9}, {
   3.663316578969328*^9, 3.6633165807202597`*^9}, {3.663316721891225*^9, 
   3.663316753146537*^9}, {3.6633172019894657`*^9, 3.663317349437574*^9}, {
   3.663317389106491*^9, 3.66331738930545*^9}, {3.663317466003957*^9, 
   3.663317468618421*^9}, {3.66331755297464*^9, 3.663317589935235*^9}, {
   3.664887956829544*^9, 3.664888019222334*^9}, {3.673664840406949*^9, 
   3.673664843421775*^9}, {3.6750555921592693`*^9, 3.675055598541807*^9}, {
   3.675056286781198*^9, 3.675056286803294*^9}, {3.675056378161018*^9, 
   3.67505638270324*^9}, {3.675056425437035*^9, 3.6750564577476673`*^9}, 
   3.675056512145671*^9, {3.678688854747075*^9, 3.678688861546611*^9}, {
   3.680351551395339*^9, 3.6803515514676867`*^9}, 3.680351644919034*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"5938585e-a642-4885-9a15-c8fec56cb381"],

Cell[BoxData[
 RowBox[{
  RowBox[{"opts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "Gray", "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "250"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "250"}], "}"}]}], "}"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.664888432071473*^9, 3.664888447016179*^9}, 
   3.664889742302809*^9, {3.664890225609192*^9, 3.664890241176641*^9}, 
   3.6803511303301086`*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"05e5cbcc-a31d-4793-a34f-866db063df58"],

Cell["Plot and export averaged vector fields for blastoderm layer.", "Text",
 CellChangeTimes->{{3.784293152642508*^9, 3.7842931886914682`*^9}, {
  3.784293298853855*^9, 
  3.7842932996275*^9}},ExpressionUUID->"51a49abf-43ae-4d00-ada1-5889cf2114f5"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../results/\>\"", "<>", "\"\<blastoderm-\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.png\>\""}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"colors", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"arrowScaling", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"ListStreamPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"popMean", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "i"}], "]"}], "]"}], "/.", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}]}], ",", 
                RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "250"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "250"}], "}"}]}], "}"}]}]}], "]"}], 
              "]"}], ",", "_Arrow", ",", "Infinity"}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"250", ",", "250"}], "}"}]}], "]"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Sequence", "@@", "opts"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
     RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67204168166326*^9, 3.672041710519144*^9}, {
   3.6736048394353313`*^9, 3.673604953483604*^9}, 3.6736051048489513`*^9, {
   3.673607383034605*^9, 3.673607386792737*^9}, {3.673607445696843*^9, 
   3.673607466825042*^9}, {3.6803511068746767`*^9, 3.68035117811182*^9}, {
   3.680351214460582*^9, 3.680351251280808*^9}, {3.68035178974254*^9, 
   3.680351879883377*^9}, {3.680352000234318*^9, 3.680352000776938*^9}, {
   3.680352102575369*^9, 3.6803521112933397`*^9}, {3.680352189854632*^9, 
   3.6803521982366543`*^9}, {3.6896656064306507`*^9, 3.689665610170897*^9}, {
   3.689665983498785*^9, 3.689665986257867*^9}, {3.689666823454068*^9, 
   3.689666829296261*^9}, 3.689666863789464*^9, {3.689667142275291*^9, 
   3.689667169468811*^9}, {3.689667249001985*^9, 3.689667254447816*^9}, {
   3.7842818901680403`*^9, 3.784281907851614*^9}, {3.784293316650908*^9, 
   3.7842933205869627`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"d8bd959d-92f7-4f62-abc9-ff528d98bf31"],

Cell["\<\
Plot and export averaged vector fields for mesendoderm layer (popMean[[2,i]]).\
\>", "Text",
 CellChangeTimes->{{3.784293152642508*^9, 3.7842931886914682`*^9}, {
  3.784293303186996*^9, 3.784293306652418*^9}, {3.7842933860996513`*^9, 
  3.784293400907393*^9}},ExpressionUUID->"1b96baca-e705-4121-82d6-\
92a1c20812df"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../results/\>\"", "<>", "\"\<mesendoderm-\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.png\>\""}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"colors", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"arrowScaling", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"ListStreamPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"popMean", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "i"}], "]"}], "]"}], "/.", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}]}], ",", 
                RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "250"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "250"}], "}"}]}], "}"}]}]}], "]"}], 
              "]"}], ",", "_Arrow", ",", "Infinity"}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"250", ",", "250"}], "}"}]}], "]"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Sequence", "@@", "opts"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
     RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67204168166326*^9, 3.672041710519144*^9}, {
   3.6736048394353313`*^9, 3.673604953483604*^9}, 3.6736051048489513`*^9, {
   3.673607383034605*^9, 3.673607386792737*^9}, {3.673607445696843*^9, 
   3.673607466825042*^9}, {3.6803511068746767`*^9, 3.68035117811182*^9}, {
   3.680351214460582*^9, 3.680351251280808*^9}, {3.68035178974254*^9, 
   3.680351879883377*^9}, {3.680352000234318*^9, 3.680352000776938*^9}, {
   3.680352102575369*^9, 3.6803521112933397`*^9}, {3.680352189854632*^9, 
   3.6803521982366543`*^9}, {3.6896656064306507`*^9, 3.689665610170897*^9}, {
   3.689665983498785*^9, 3.689665986257867*^9}, {3.689666823454068*^9, 
   3.689666829296261*^9}, 3.689666863789464*^9, {3.689667142275291*^9, 
   3.689667169468811*^9}, {3.689667249001985*^9, 3.689667254447816*^9}, {
   3.7842818901680403`*^9, 3.784281907851614*^9}, {3.784293308847946*^9, 
   3.784293313665971*^9}, {3.784293379302038*^9, 3.784293379394499*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"d8937c83-66f8-4ad2-8867-5e2098f97939"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selected streamlines", "Section",
 CellChangeTimes->{{3.6651266101970997`*^9, 
  3.665126613875901*^9}},ExpressionUUID->"57a567a8-2e0a-49eb-a223-\
edf13dfa79a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "createMercatorTracks", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createMercatorTracks", "[", "tracks_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", ",", "mercatorTracks"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", "#"}], "->", 
          RowBox[{"ToMercator", "@", 
           RowBox[{"ToSpherical", "[", 
            RowBox[{"Normalize", "/@", 
             RowBox[{"Last", "@", "#"}]}], "]"}]}]}], "&"}], ",", "tracks", 
        ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mercatorTracks", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Last", "@", "#"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "@", "#"}], ",", 
                 RowBox[{
                  RowBox[{"First", "@", "#"}], "+", 
                  RowBox[{"Length", "@", 
                   RowBox[{"Last", "@", "#"}]}], "-", "1"}]}], "}"}]}], 
              "]"}]}], "}"}], "]"}]}], "&"}], ",", "tmp", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
     RowBox[{"mercatorTracks", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_", ",", "t_"}], "}"}], "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"0.01", ",", "x"}], "]"}], ",", "999.99"}], "]"}], 
             ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"0.01", ",", "y"}], "]"}], ",", "999.99"}], "]"}], 
             ",", "t"}], "}"}]}]}], "&"}], ",", "mercatorTracks", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.661144295473453*^9, 3.66114438437991*^9}, {
   3.661144491072197*^9, 3.661144493367573*^9}, {3.661146956571928*^9, 
   3.6611469996539583`*^9}, {3.66116435189212*^9, 3.661164352488976*^9}, {
   3.661754188094445*^9, 3.661754189540679*^9}, {3.661755543842567*^9, 
   3.661755561820207*^9}, {3.661766321196604*^9, 3.661766343830594*^9}, {
   3.6617664542733297`*^9, 3.661766468932611*^9}, {3.661778996168564*^9, 
   3.66177900204154*^9}, {3.66178092959237*^9, 3.661780934715633*^9}, 
   3.661781081539034*^9, {3.66289382355331*^9, 3.662893838583358*^9}, {
   3.6628943591608467`*^9, 3.6628943716794243`*^9}, {3.664714075615086*^9, 
   3.6647141347518578`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"324bc95a-d8a7-4207-9d6f-9453ac2cc9f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mercatorTracks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"createMercatorTracks", "[", "#", "]"}], "&"}], "/@", 
    "tracks"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664714141976862*^9, 3.6647141583639927`*^9}, {
  3.6647142163391438`*^9, 3.6647142174908533`*^9}, {3.664775179128978*^9, 
  3.664775182470851*^9}, {3.664775236792466*^9, 3.664775237445137*^9}, {
  3.6647753606025963`*^9, 3.664775361790783*^9}, {3.6647757973298683`*^9, 
  3.664775800760165*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"6653b86f-9553-4ce0-ba8c-38513409f88e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timepoints", "=", 
   RowBox[{"{", 
    RowBox[{"105", ",", "147"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step", "=", "42"}], ";"}]}], "Input",
 CellChangeTimes->{{3.665129211267771*^9, 3.6651292282472057`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"cc608168-8866-4451-9099-28534640c68c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"germLayers", "=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"eSpatioTemporalSeparation", "[", 
        RowBox[{
        "#", ",", "timepoints", ",", "spatialResolution", ",", "step", ",", 
         RowBox[{"{", 
          RowBox[{"1000", ",", "1000"}], "}"}], ",", 
         RowBox[{"CoordinateOrigin", "\[Rule]", "\"\<Mercator\>\""}], ",", 
         RowBox[{"OriginalDimensions", "\[Rule]", "  ", 
          RowBox[{"{", 
           RowBox[{"1000", ",", "1000"}], "}"}]}], ",", 
         RowBox[{"Radius", "\[Rule]", "  ", "1"}]}], "]"}], 
       "\[IndentingNewLine]", ")"}], "&"}], ",", "mercatorTracks", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664714237155774*^9, 3.6647142871470747`*^9}, {
  3.665126647997315*^9, 3.665126662579281*^9}, {3.665126705490086*^9, 
  3.6651267237615356`*^9}, {3.665129230662511*^9, 3.665129235989978*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"855a5f11-c0d4-4978-849c-ef70f1107f19"],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "germLayers"}]], "Input",
 CellChangeTimes->{{3.6651268166367607`*^9, 3.665126822760317*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"643b70b4-d5de-4ced-ba54-1915c05131a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"averageFields", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eComputeAverageField", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ReplaceMissing", "\[Rule]", "True"}], ",", 
        RowBox[{"ConvertToImageCS", "\[Rule]", "True"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<Median\>\""}]}], "]"}], "&"}], ",", 
     "germLayers", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.665127990329167*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"91b9a41b-16f6-490e-99ff-26fff8ac691c"],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "averageFields"}]], "Input",
 CellChangeTimes->{{3.665127992863789*^9, 3.665127995733733*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"7a8e576b-bfab-4768-8507-572cfc292521"],

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"#2", "<>", "\"\<streams-part.png\>\""}], ",", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListStreamPlot", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
               RowBox[{"StreamStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Drop\>\"", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", 
                RowBox[{"Directive", "[", "Gray", "]"}]}], ",", 
               RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}], ",", 
             RowBox[{"ListStreamPlot", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
               RowBox[{"StreamStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Drop\>\"", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", 
                RowBox[{"Directive", "[", "Gray", "]"}]}], ",", 
               RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ListStreamPlot", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
               RowBox[{"StreamStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Drop\>\"", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", 
                RowBox[{"Directive", "[", "Gray", "]"}]}], ",", 
               RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"Background", "\[Rule]", "Black"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"averageFields", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<../results/sample-1/\>\"", ",", "\"\<../results/sample-2/\>\"", 
       ",", "\"\<../results/sample-3/\>\""}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.664777175426527*^9, 3.6647774424480867`*^9}, {
   3.6647778731082783`*^9, 3.6647779768075314`*^9}, {3.664778247973328*^9, 
   3.664778254422636*^9}, {3.664784437069479*^9, 3.664784447907146*^9}, {
   3.664870522030835*^9, 3.6648705316682777`*^9}, {3.665128057537078*^9, 
   3.665128058367056*^9}, {3.665128100016993*^9, 3.665128100286764*^9}, 
   3.665128132447611*^9, {3.784453244423697*^9, 3.784453272271043*^9}, {
   3.784459177653205*^9, 
   3.784459186109151*^9}},ExpressionUUID->"e47c1c30-424e-45bc-a57e-\
a4b46d1018a0"],

Cell[CellGroupData[{

Cell["Population mean", "Subsection",
 CellChangeTimes->{{3.665128941560816*^9, 
  3.665128944063404*^9}},ExpressionUUID->"57219199-5142-45cb-816d-\
6299a7f8ec9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"popMean", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Mean", ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"averageFields", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}],
      ",", 
     RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.66478068448025*^9, 3.6647807154771338`*^9}, {
   3.6647807891802588`*^9, 3.664780801273436*^9}, {3.664780899675972*^9, 
   3.664780906323861*^9}, 3.664782167912155*^9, {3.664782199671876*^9, 
   3.664782202646269*^9}, 3.6647822361630993`*^9},
 CellLabel->
  "In[131]:=",ExpressionUUID->"5c73a634-0f3a-4d8c-890f-4f7f46d6bc41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gr", "=", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListStreamPlot", "[", 
           RowBox[{
            RowBox[{"popMean", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
            RowBox[{"StreamStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Drop\>\"", ",", 
               RowBox[{"colors", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Gray", "]"}]}], ",", 
            RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}], ",", 
          RowBox[{"ListStreamPlot", "[", 
           RowBox[{
            RowBox[{"popMean", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
            RowBox[{"StreamStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Drop\>\"", ",", 
               RowBox[{"colors", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Gray", "]"}]}], ",", 
            RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStreamPlot", "[", 
           RowBox[{
            RowBox[{"popMean", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
            RowBox[{"StreamStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Drop\>\"", ",", 
               RowBox[{"colors", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Gray", "]"}]}], ",", 
            RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"Background", "\[Rule]", "Black"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664780719517886*^9, 3.664780728229567*^9}, {
  3.664782288112165*^9, 3.66478229098368*^9}, {3.665128954704763*^9, 
  3.665128971513337*^9}, {3.784453284751359*^9, 3.7844532927123404`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"ca02941a-b276-4a49-af7c-e980af66516a"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../results/streams-part.png\>\"", ",", "gr"}], "]"}]], "Input",\

 CellChangeTimes->{{3.665128980951297*^9, 3.6651289816943283`*^9}, {
  3.7844532972439833`*^9, 3.784453299011203*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"7eb27898-e397-4e8a-89d4-695f0d9be380"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition of movement components", "Section",
 CellChangeTimes->{{3.665229183481133*^9, 
  3.665229192207837*^9}},ExpressionUUID->"b31a1e1a-5eda-4d31-b18c-\
158e2a434854"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"brewerScale", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{"#", "/", "255."}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"178", ",", "24", ",", "43"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"214", ",", "96", ",", "77"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"244", ",", "165", ",", "130"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"253", ",", "219", ",", "199"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"247", ",", "247", ",", "247"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"209", ",", "229", ",", "240"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"146", ",", "197", ",", "222"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"67", ",", "147", ",", "195"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"33", ",", "102", ",", "172"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"1", "-", "#"}]}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"factor", "=", "1.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordinates", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0.5", ",", "39.5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", ".5", ",", "39.5", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6525852046890507`*^9, 3.6525852230004797`*^9}, {
  3.653622944056775*^9, 3.653622951183077*^9}, {3.653622989875618*^9, 
  3.653622992266076*^9}, {3.653623027124571*^9, 3.653623032986847*^9}, {
  3.653623069632133*^9, 3.653623089213315*^9}, {3.663478079970612*^9, 
  3.663478083224957*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"fe25bef0-d384-433a-b306-0c9b108ed682"],

Cell[BoxData[
 RowBox[{
  RowBox[{"spatialResolution", "=", "40"}], ";"}]], "Input",
 CellChangeTimes->{{3.664892771575199*^9, 3.6648927756230173`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"f84847b4-375b-4372-b4a7-ba46a1c51c47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mercatorCoordinates", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"j", "+", ".5"}], ",", 
       RowBox[{"i", "+", ".5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"spatialResolution", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"spatialResolution", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"polarCoordinates", "=", 
   RowBox[{"ToSpherical", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"mercatorCoordinates", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"OriginalDimensions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"spatialResolution", ",", "spatialResolution"}], "}"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6527835017501097`*^9, 3.652783502678707*^9}, {
  3.6534645567777576`*^9, 3.653464558067709*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"197f4bd1-2155-4992-9ac3-b1f2fd00cadc"],

Cell[BoxData[
 RowBox[{"animalPolePosition", "=", 
  RowBox[{"ToSpherical", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"88.", ",", "500."}], "}"}], ",", 
    RowBox[{"OriginalDimensions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1000", ",", "1000"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.689316144034091*^9, 3.689316181135133*^9}, {
   3.689316265350431*^9, 3.6893162654920597`*^9}, 3.689321489057959*^9, {
   3.6893218766855803`*^9, 3.6893218856353703`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"a40ca009-6e5a-44e8-a085-2607bfa07417"],

Cell[BoxData[
 RowBox[{"vegetalPolePosition", "=", 
  RowBox[{"ToSpherical", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"23.52`", ",", "20."}], "}"}], ",", 
    RowBox[{"OriginalDimensions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"40", ",", "40"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.663476702129301*^9, 3.6634767347595663`*^9}, {
   3.663476899064825*^9, 3.663476907179727*^9}, {3.6893165880409727`*^9, 
   3.689316593573772*^9}, {3.689321539094852*^9, 3.689321539933599*^9}, 
   3.689321928085382*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"1ab36bf6-57df-475b-b5c8-b8fbeb157cd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"funcs", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eComputeGeodesic", "[", 
       RowBox[{"#", ",", "vegetalPolePosition"}], "]"}], "&"}], ",", 
     "polarCoordinates"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epibolyMovement", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"distance", "=", 
           RowBox[{"eGreatCircleDistance", "[", 
            RowBox[{"vegetalPolePosition", ",", 
             RowBox[{"#", "[", "0", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"to", "=", 
           RowBox[{"0.01", "/", "distance"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"first", "=", 
           RowBox[{"ToMercator", "[", 
            RowBox[{"#", "[", "to", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"second", "=", 
           RowBox[{"ToMercator", "[", 
            RowBox[{"#", "[", "0", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"first", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"second", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"second", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"first", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", ")"}], "&"}], ",", "funcs"}], "]"}], ",", 
     "spatialResolution"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.645765869645982*^9, 3.6457658735490923`*^9}, {
   3.645765923845017*^9, 3.645765927677188*^9}, 3.645767070909811*^9, {
   3.6458603577355413`*^9, 3.645860360714033*^9}, {3.645860608619277*^9, 
   3.645860612166152*^9}, 3.645860699248065*^9, {3.645863330510418*^9, 
   3.645863431518746*^9}, {3.645940275141138*^9, 3.645940277163331*^9}, {
   3.648364213870776*^9, 3.648364358647234*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"02309528-374c-4508-acee-47cbae0725ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"normalizedEpibolyMovement", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Normalize", ",", "epibolyMovement", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.648364457891038*^9, 3.648364487241042*^9}, {
  3.67974184328196*^9, 3.679741845042198*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"6e042396-058d-4cb1-a1f2-8c167bc59666"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convergenceMovement", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Normalize", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Last", "@", "#"}], ",", 
           RowBox[{"-", 
            RowBox[{"First", "@", "#"}]}]}], "}"}]}], "&"}], ",", 
       RowBox[{"Take", "[", 
        RowBox[{"normalizedEpibolyMovement", ",", 
         RowBox[{
          RowBox[{"Length", "@", "normalizedEpibolyMovement"}], "/", "2"}]}], 
        "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Last", "@", "#"}]}], ",", 
          RowBox[{"First", "@", "#"}]}], "}"}], "&"}], ",", 
       RowBox[{"Take", "[", 
        RowBox[{"normalizedEpibolyMovement", ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Length", "@", "normalizedEpibolyMovement"}]}], "/", 
          "2"}]}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.649139802760223*^9, 3.649139803858017*^9}, {
  3.64914001633524*^9, 3.64914007690147*^9}, {3.64914010996733*^9, 
  3.6491401789093437`*^9}, {3.6491405931693783`*^9, 3.6491406071273193`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"cb8bbef5-e955-4f05-9fbc-8ab22e384171"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListVectorPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", "normalizedEpibolyMovement"}], ",", "2"}], 
        "]"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", " ", 
          RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"ToMercator", "[", "vegetalPolePosition", "]"}], "]"}]}], 
         "}"}]}], ",", 
       RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"PointSize", "[", "Large", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "@", 
           RowBox[{"ToMercator", "[", 
            RowBox[{"#", ",", 
             RowBox[{"OriginalDimensions", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"40", ",", "40"}], "}"}]}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"animalPolePosition", ",", "vegetalPolePosition"}], 
          "}"}]}]}], "}"}], "]"}]}], "]"}], ",", 
   RowBox[{"ListVectorPlot", "[", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", "convergenceMovement"}], ",", "2"}], "]"}], 
     ",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", " ", 
        RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
        RowBox[{"Point", "[", 
         RowBox[{"ToMercator", "[", "vegetalPolePosition", "]"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.649408447760372*^9, 3.6494084538107033`*^9}, {
  3.663476951918838*^9, 3.6634769544139214`*^9}, {3.66347699190596*^9, 
  3.663477003338373*^9}, {3.689316628567069*^9, 3.6893167013182898`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"320c70e0-752e-46e4-9594-d665dd6e9a4a"],

Cell[CellGroupData[{

Cell["For each sample", "Subsection",
 CellChangeTimes->{{3.6648926827078943`*^9, 3.664892685771824*^9}, {
  3.784459272892891*^9, 
  3.784459282111397*^9}},ExpressionUUID->"d25aaadf-77bb-4b2c-9380-\
81d725954128"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "createMercatorTracks", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createMercatorTracks", "[", "tracks_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", ",", "mercatorTracks"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", "#"}], "->", 
          RowBox[{"ToMercator", "@", 
           RowBox[{"ToSpherical", "[", 
            RowBox[{"Normalize", "/@", 
             RowBox[{"Last", "@", "#"}]}], "]"}]}]}], "&"}], ",", "tracks", 
        ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mercatorTracks", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Last", "@", "#"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "@", "#"}], ",", 
                 RowBox[{
                  RowBox[{"First", "@", "#"}], "+", 
                  RowBox[{"Length", "@", 
                   RowBox[{"Last", "@", "#"}]}], "-", "1"}]}], "}"}]}], 
              "]"}]}], "}"}], "]"}]}], "&"}], ",", "tmp", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
     RowBox[{"mercatorTracks", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_", ",", "t_"}], "}"}], "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"0.01", ",", "x"}], "]"}], ",", "999.99"}], "]"}], 
             ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"0.01", ",", "y"}], "]"}], ",", "999.99"}], "]"}], 
             ",", "t"}], "}"}]}]}], "&"}], ",", "mercatorTracks", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.661144295473453*^9, 3.66114438437991*^9}, {
   3.661144491072197*^9, 3.661144493367573*^9}, {3.661146956571928*^9, 
   3.6611469996539583`*^9}, {3.66116435189212*^9, 3.661164352488976*^9}, {
   3.661754188094445*^9, 3.661754189540679*^9}, {3.661755543842567*^9, 
   3.661755561820207*^9}, {3.661766321196604*^9, 3.661766343830594*^9}, {
   3.6617664542733297`*^9, 3.661766468932611*^9}, {3.661778996168564*^9, 
   3.66177900204154*^9}, {3.66178092959237*^9, 3.661780934715633*^9}, 
   3.661781081539034*^9, {3.66289382355331*^9, 3.662893838583358*^9}, {
   3.6628943591608467`*^9, 3.6628943716794243`*^9}, {3.664714075615086*^9, 
   3.6647141347518578`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"1d592c6a-97b4-4960-8cd8-679046ddea9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mercatorTracks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"createMercatorTracks", "[", "#", "]"}], "&"}], "/@", 
    "tracks"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664714141976862*^9, 3.6647141583639927`*^9}, {
  3.6647142163391438`*^9, 3.6647142174908533`*^9}, {3.664775179128978*^9, 
  3.664775182470851*^9}, {3.664775236792466*^9, 3.664775237445137*^9}, {
  3.6647753606025963`*^9, 3.664775361790783*^9}, {3.6647757973298683`*^9, 
  3.664775800760165*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"0641d03a-eb4c-4630-b65d-82d4cf0a3b5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timeResolution", "=", "42"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spatialResolution", "=", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"germLayers", "=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"early", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"late", "=", "420"}], ";", "\[IndentingNewLine]", 
        RowBox[{"step", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"late", "-", "early"}], ")"}], "/", 
          RowBox[{"(", "timeResolution", ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eSpatioTemporalSeparation", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Round", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "early", ",", 
              RowBox[{"late", "-", "step"}], ",", "step"}], "}"}]}], "]"}], 
          ",", "spatialResolution", ",", 
          RowBox[{"Round", "@", "step"}], ",", 
          RowBox[{"{", 
           RowBox[{"1000", ",", "1000"}], "}"}], ",", 
          RowBox[{"CoordinateOrigin", "\[Rule]", "\"\<Mercator\>\""}], ",", 
          RowBox[{"OriginalDimensions", "\[Rule]", "  ", 
           RowBox[{"{", 
            RowBox[{"1000", ",", "1000"}], "}"}]}], ",", 
          RowBox[{"Radius", "\[Rule]", "  ", "1"}]}], "]"}]}], 
       "\[IndentingNewLine]", ")"}], "&"}], ",", "mercatorTracks", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.664714237155774*^9, 3.6647142871470747`*^9}, {
  3.6652357047910643`*^9, 3.665235704846758*^9}, {3.6786025431484423`*^9, 
  3.678602543284191*^9}, {3.679653786932976*^9, 3.679653787676527*^9}, {
  3.6797418821314898`*^9, 3.6797418900503807`*^9}, {3.679745134826542*^9, 
  3.679745152458131*^9}, {3.6895779298211327`*^9, 3.689577930013052*^9}, {
  3.6895844495512533`*^9, 3.689584449677754*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"f0de3eb1-c7c5-4477-a579-972bb669208b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "*", 
         RowBox[{"If", "[", "___", "]"}]}], ",", "_"}], "}"}], "\[Rule]", 
      RowBox[{"Missing", "[", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"_", "*", 
         RowBox[{"If", "[", "___", "]"}]}]}], "}"}], "\[Rule]", 
      RowBox[{"Missing", "[", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", "___", "]"}], ",", "_"}], "}"}], "\[Rule]", 
      RowBox[{"Missing", "[", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"If", "[", "___", "]"}]}], "}"}], "\[Rule]", 
      RowBox[{"Missing", "[", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.648379287353595*^9, 3.648379309373989*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"9e388060-827f-4503-8774-e3dc9b384078"],

Cell[BoxData[
 RowBox[{
  RowBox[{"averageFields", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eComputeAverageField", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ReplaceMissing", "\[Rule]", "False"}], ",", 
        RowBox[{"ConvertToImageCS", "\[Rule]", "False"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<Mean\>\""}]}], "]"}], "&"}], ",", 
     "germLayers", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664892918565371*^9, 3.66489293086019*^9}, {
  3.679744992587802*^9, 3.679744997056858*^9}, {3.682660908926903*^9, 
  3.682660909222658*^9}, {3.682745994030705*^9, 3.6827459946773243`*^9}, {
  3.682746121212269*^9, 3.6827461216028347`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"6714884e-cfe0-4537-a97f-501a920e016b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"normalizedData", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Normalize", ",", "#", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
       RowBox[{
        FractionBox[
         RowBox[{"Missing", "[", "]"}], 
         RowBox[{"Norm", "[", 
          RowBox[{"Missing", "[", "]"}], "]"}]], "\[Rule]", 
        RowBox[{"Missing", "[", "]"}]}]}], "&"}], ",", "averageFields", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.663477197303862*^9, 3.663477281563301*^9}, {
  3.6648929593017817`*^9, 3.664892967948387*^9}, {3.6797450436556*^9, 
  3.679745048340756*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"d61ab5a3-d9e8-41f7-b756-de5504747ae0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"epibolyScalarProduct", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", ".", "#2"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"#", ",", "normalizedEpibolyMovement"}], "}"}], ",", "2"}], 
        "]"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"Missing", "[", "]"}], ".", "_"}], "\[Rule]", 
        RowBox[{"Missing", "[", "]"}]}]}], "&"}], ",", "normalizedData", ",", 
     
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"convergenceScalarProduct", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", ".", "#2"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"#", ",", "convergenceMovement"}], "}"}], ",", "2"}], "]"}],
        "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"Missing", "[", "]"}], ".", "_"}], "\[Rule]", 
        RowBox[{"Missing", "[", "]"}]}]}], "&"}], ",", "normalizedData", ",", 
     
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.648365250009059*^9, 3.6483653602572937`*^9}, 
   3.648376822145719*^9, {3.663477391604003*^9, 3.663477411890009*^9}, {
   3.664892974924349*^9, 3.664893025751746*^9}, {3.679745056575832*^9, 
   3.67974506910287*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"224f7ad0-4d2f-4f83-9812-6675538ba290"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "scale2", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale2", "[", "x_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{
     RowBox[{"ArcCos", "[", 
      RowBox[{"Max", "[", 
       RowBox[{"0", ",", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Missing", "[", "]"}], "\[Rule]", "0"}]}]}], "]"}], "]"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{"Pi", "/", "2"}], ")"}]}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.652785672931398*^9, 3.652785683434946*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"c7846a91-e9e8-44e7-8d29-9fca7e447690"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"convergenceScale", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"scale2", "[", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", "#"}], "]"}], "]"}], "&"}], ",", 
     "convergenceScalarProduct", ",", 
     RowBox[{"{", "5", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"epibolyScale", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"scale2", "[", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", "#"}], "]"}], "]"}], "&"}], ",", 
     "epibolyScalarProduct", ",", 
     RowBox[{"{", "5", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"residualScale", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"spatialResolution", ",", "spatialResolution"}], "}"}]}], 
        "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"#1", "+", "#2"}], ")"}]}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"convergenceScale", ",", "epibolyScale"}], "}"}], ",", "3"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"residualScale", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"scale2", ",", "#", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"#1", "+", "#2"}], ")"}]}], ")"}]}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"convergenceScale", ",", "epibolyScale"}], "}"}]}], "]"}]}], 
    ";", " ", 
    RowBox[{"former", " ", "scaling", " ", "computation"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.652785789565473*^9, 3.652785808377677*^9}, {
   3.6527858934194107`*^9, 3.6527859160504827`*^9}, {3.6634800274721537`*^9, 
   3.663480040502407*^9}, {3.663481694861064*^9, 3.6634817298048773`*^9}, {
   3.663593912693471*^9, 3.663593939785763*^9}, {3.663669685720757*^9, 
   3.6636697470435343`*^9}, 3.663669983573916*^9, {3.6636705105162992`*^9, 
   3.663670515314632*^9}, {3.6648948393779793`*^9, 3.6648948826487303`*^9}, {
   3.679816014021882*^9, 3.679816030828568*^9}, {3.6895841754319067`*^9, 
   3.689584187628921*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"edf9054f-4af8-480a-abef-8d89063a8587"],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "epibolyScale"}]], "Input",
 CellChangeTimes->{{3.6895840671750603`*^9, 3.689584089035058*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"2a991510-9291-4c01-a284-7f735f9ab883"],

Cell[BoxData[
 RowBox[{
  RowBox[{"counts", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Length", ",", 
     RowBox[{"germLayers", "/.", 
      RowBox[{
       RowBox[{"Missing", "[", "]"}], "\[Rule]", 
       RowBox[{"{", "}"}]}]}], ",", 
     RowBox[{"{", "5", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.66489490011552*^9, 3.664894905595354*^9}, {
  3.664894959836197*^9, 3.6648949640603867`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"0129f645-2cd3-495d-8000-d5c890f147ec"],

Cell[CellGroupData[{

Cell["movement components per germlayer", "Subsubsection",
 CellChangeTimes->{{3.6652359456848297`*^9, 3.6652359552357273`*^9}, {
  3.7844593373357563`*^9, 
  3.784459339798991*^9}},ExpressionUUID->"b37a58c9-2173-418d-95ca-\
2c8e98745f1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"name", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<blastoderm\>\"", ",", "\"\<mesendoderm\>\"", ",", 
     "\"\<endoderm\>\""}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.664895146686738*^9, {3.784461942983391*^9, 3.784461954126799*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"79934a1f-0a52-4017-8176-7b49e752b330"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcomp", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Total", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"#1", "*", 
             RowBox[{"#4", "/", 
              RowBox[{"Total", "@", 
               RowBox[{"Flatten", "[", "#4", "]"}]}]}]}], "]"}]}], ",", 
          RowBox[{"Total", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"#2", "*", 
             RowBox[{"#4", "/", 
              RowBox[{"Total", "@", 
               RowBox[{"Flatten", "[", "#4", "]"}]}]}]}], "]"}]}], ",", 
          RowBox[{"Total", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"#3", "*", 
             RowBox[{"#4", "/", 
              RowBox[{"Total", "@", 
               RowBox[{"Flatten", "[", "#4", "]"}]}]}]}], "]"}]}]}], "}"}], 
        "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "epibolyScale", ",", "convergenceScale", ",", "residualScale", ",", 
         "counts"}], "}"}], ",", "3"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.665123108302647*^9, 3.665123168180052*^9}, {
  3.66523578735466*^9, 3.665235789554614*^9}, {3.6895819324166803`*^9, 
  3.689581937369636*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"4672bdb1-9b0f-4821-b28c-356142e60b25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gr", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "12.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"4", ",", "0"}], "}"}]}]}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"First", "@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ListLinePlot", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "#2"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "18"}], "}"}]}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"brewerScale", "[", "0", "]"}], ",", 
                RowBox[{"brewerScale", "[", "1", "]"}], ",", "Gray"}], 
               "}"}]}], "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"Transpose", "[", 
           RowBox[{"mcomp", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "name"}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.703394684551989*^9, 3.7033946980119963`*^9}, {
  3.703394735806931*^9, 3.7033947437316504`*^9}, {3.703399607589616*^9, 
  3.7033996084603243`*^9}, {3.70339964409135*^9, 3.703399740608295*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"f131b4de-f7ab-4171-838d-e6adc311421f"],

Cell[BoxData[{
 RowBox[{"i", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"gr", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "12.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"First", "@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ListLinePlot", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "#2"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "18"}], "}"}]}], ",", 
               RowBox[{"AxesOrigin", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "0"}], "}"}]}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "colors"}], "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"Transpose", "[", 
           RowBox[{"mcomp", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<epiboly\>\"", ",", "\"\<convergence\>\"", ",", 
        "\"\<residual\>\""}], "}"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.703399870662973*^9, 3.703399902263928*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"78e113fd-0135-42b8-8ef5-d649793bc319"],

Cell[BoxData[
 RowBox[{"eExportList", "[", 
  RowBox[{"\"\<../results/single-dynamics/\>\"", ",", "gr", ",", 
   RowBox[{"ExportFormat", "\[Rule]", "\"\<PDF\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.703400024042531*^9, 3.703400059199527*^9}, {
  3.784462020928218*^9, 3.784462053052436*^9}, {3.784462170532166*^9, 
  3.784462174498723*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"b2f6caaa-1660-4d28-96d7-93e3a9896809"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Population level", "Subsection",
 CellChangeTimes->{{3.6652357743711557`*^9, 
  3.6652357771781588`*^9}},ExpressionUUID->"db4ba137-b4f6-4b36-b08a-\
aa6c066a48b4"],

Cell[CellGroupData[{

Cell["per germlayer", "Subsubsection",
 CellChangeTimes->{{3.665235817594232*^9, 
  3.665235821025264*^9}},ExpressionUUID->"02d69268-787d-46d2-8163-\
401eee8c672b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ConfidencePlot", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BaseStyle", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"Ticks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", ".5", ",", "1."}], "}"}]}], "}"}]}]}], "}"}], 
    ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.679816986819927*^9, 3.67981708261998*^9}, {
   3.6798173027997293`*^9, 3.67981730386452*^9}, 3.679817407845427*^9, {
   3.679834866284606*^9, 3.679834866585747*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"3d0f3b63-1542-4018-93ff-5d5fbd18f188"],

Cell[BoxData[
 RowBox[{"epiboly", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConfidencePlot", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", "#"}], ",", "16"}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"4", ",", "9.333"}], "}"}]}], ",", 
          RowBox[{"Color", "->", 
           RowBox[{"brewerScale", "[", "0", "]"}]}]}], "]"}], ",", 
        RowBox[{"ConfidencePlot", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", "#"}], ",", "15"}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"9.333", ",", "18"}], "}"}]}], ",", 
          RowBox[{"LineStyle", "\[Rule]", "Dotted"}], ",", 
          RowBox[{"Color", "->", 
           RowBox[{"brewerScale", "[", "0", "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Transpose", "[", 
      RowBox[{"mcomp", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], "}"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.67860607454655*^9, 3.678606148869576*^9}, {
   3.678606307291408*^9, 3.678606393400214*^9}, {3.678606429169689*^9, 
   3.678606455148355*^9}, {3.678606488701089*^9, 3.6786066247215548`*^9}, {
   3.678606677585321*^9, 3.6786066871430264`*^9}, {3.678606728671928*^9, 
   3.678606729479301*^9}, {3.678607323635861*^9, 3.678607333433812*^9}, {
   3.6786075037972193`*^9, 3.678607507780978*^9}, {3.678607542793242*^9, 
   3.678607558838778*^9}, {3.6786076719954*^9, 3.6786077191931353`*^9}, {
   3.679816166493322*^9, 3.6798162046962643`*^9}, {3.679817037134816*^9, 
   3.679817043246921*^9}, {3.68932284835238*^9, 3.689322872365485*^9}, 
   3.689582004679824*^9},
 CellLabel->
  "In[179]:=",ExpressionUUID->"e8eb8bbc-7e47-44b3-b990-544f2657889d"],

Cell[BoxData[
 RowBox[{"gr", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "#1", "}"}], ",", 
         RowBox[{"Drop", "[", 
          RowBox[{"#2", ",", "1"}], "]"}]}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "12.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"epiboly", ",", 
      RowBox[{"First", "@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ConfidencePlot", "[", 
              RowBox[{
               RowBox[{"Transpose", "@", "#1"}], ",", 
               RowBox[{"Color", "\[Rule]", "#2"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "18"}], "}"}]}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"brewerScale", "[", "0", "]"}], ",", 
                RowBox[{"brewerScale", "[", "1", "]"}], ",", "Gray"}], 
               "}"}]}], "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"Transpose", "[", 
           RowBox[{"mcomp", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "name"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.665123208266623*^9, 3.665123208560886*^9}, {
   3.665123244411314*^9, 3.665123261144815*^9}, {3.665123297204774*^9, 
   3.665123298250757*^9}, {3.665123380009595*^9, 3.6651233804733667`*^9}, 
   3.665235794084929*^9, {3.678603159398467*^9, 3.678603166837134*^9}, {
   3.6786032152100163`*^9, 3.6786032200001287`*^9}, {3.678605797891314*^9, 
   3.6786057993611917`*^9}, {3.678605842770132*^9, 3.678605937697545*^9}, {
   3.678607763885206*^9, 3.6786078046731453`*^9}, {3.679816238467155*^9, 
   3.679816247593355*^9}, {3.6798163836358843`*^9, 3.6798163839942493`*^9}, {
   3.679816470989612*^9, 3.679816473192128*^9}, {3.6798174148777533`*^9, 
   3.679817415052313*^9}, {3.689582024198409*^9, 3.68958202482094*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"f76ff661-ac0b-44c2-aa45-ef1dc687f65e"],

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\<../results/mcomponents_per_layer-\>\"", "<>", "#1", "<>", 
       "\"\<.pdf\>\""}], ",", "#2"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"name", ",", "gr"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6651233967834797`*^9, 3.665123412824892*^9}, {
  3.665236096169112*^9, 3.665236096257332*^9}, {3.678607822464099*^9, 
  3.678607898305949*^9}, {3.679816419410118*^9, 3.6798164453237963`*^9}, {
  3.679817054646118*^9, 3.6798170554927397`*^9}, {3.679817093052182*^9, 
  3.6798170931957493`*^9}, {3.679817421099688*^9, 3.679817421835441*^9}, {
  3.682746279197329*^9, 3.682746279373516*^9}, {3.784462293359722*^9, 
  3.784462296010025*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"256d17ad-746c-449c-82d5-80e4aa3fee53"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["per movement component", "Subsection",
 CellChangeTimes->{{3.665235827633243*^9, 
  3.6652358328411303`*^9}},ExpressionUUID->"d529bc67-23b8-429f-b927-\
e69472b3e832"],

Cell[BoxData[
 RowBox[{"gr", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "12.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"First", "@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ConfidencePlot", "[", 
              RowBox[{
               RowBox[{"Transpose", "@", "#1"}], ",", 
               RowBox[{"Color", "\[Rule]", "#2"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "18"}], "}"}]}], ",", 
               RowBox[{"AxesOrigin", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "0"}], "}"}]}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "colors"}], "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"Transpose", "[", 
           RowBox[{"mcomp", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<epiboly\>\"", ",", "\"\<convergence\>\"", ",", 
        "\"\<residual\>\""}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.664896161055326*^9, 3.66489616873988*^9}, {
   3.6648962804237967`*^9, 3.664896382742014*^9}, {3.664896489040689*^9, 
   3.664896607213355*^9}, {3.6648966519958963`*^9, 3.6648966977081347`*^9}, {
   3.664896745845759*^9, 3.6648967510368958`*^9}, {3.66489704894449*^9, 
   3.664897190001607*^9}, {3.664897222914274*^9, 3.664897249737319*^9}, {
   3.678608009923152*^9, 3.6786080122500973`*^9}, {3.678608075858667*^9, 
   3.6786080880645723`*^9}, {3.6786083362347927`*^9, 
   3.6786083552008457`*^9}, {3.679816480908832*^9, 3.679816537202498*^9}, {
   3.679816684955469*^9, 3.6798166892912827`*^9}, {3.679816844815868*^9, 
   3.6798168655992393`*^9}, 3.679817017689054*^9, {3.679817109483286*^9, 
   3.6798171109854517`*^9}, {3.6798173893661127`*^9, 3.67981738958856*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"c1adcaf9-29f7-43be-bbe2-5074e95f723b"],

Cell[BoxData[
 RowBox[{"eExportList", "[", 
  RowBox[{"\"\<../results/\>\"", ",", "gr", ",", 
   RowBox[{"ExportFormat", "\[Rule]", "\"\<PDF\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7034003800180197`*^9, 3.703400426797125*^9}, {
  3.784552459887971*^9, 3.784552485403216*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"5497c41f-30b4-474c-998c-6c03f271999b"],

Cell[BoxData[
 RowBox[{"epiboly", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConfidencePlot", "[", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", "#1"}], ",", "16"}], "]"}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"4", ",", "9.333"}], "}"}]}], ",", 
            RowBox[{"Color", "\[Rule]", "#2"}]}], "]"}], ",", 
          RowBox[{"ConfidencePlot", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", "#1"}], ",", "15"}], "]"}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"9.333", ",", "18"}], "}"}]}], ",", 
            RowBox[{"LineStyle", "\[Rule]", "Dotted"}], ",", 
            RowBox[{"Color", "\[Rule]", "#2"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "12.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"mcomp", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "colors"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678608402296138*^9, 3.678608571648828*^9}, {
  3.679816560011392*^9, 3.67981660312914*^9}, {3.6798167097788677`*^9, 
  3.67981671303435*^9}, {3.679816932574185*^9, 3.679816948263073*^9}, {
  3.6798171152108593`*^9, 3.679817127496544*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"e2f62058-4216-4ede-8d4d-29d0415316dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"name", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<epiboly\>\"", ",", "\"\<convergence\>\"", ",", "\"\<residual\>\""}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678608644279765*^9, 3.6786086464958467`*^9}, {
  3.6798348445249777`*^9, 3.679834845514163*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"922b27ef-02b1-4ee9-98e6-3b6a761b27ef"],

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\<../results/mcomponents_per_movement-\>\"", "<>", "#1", "<>", 
       "\"\<.pdf\>\""}], ",", "#2"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"name", ",", 
     RowBox[{"{", 
      RowBox[{"epiboly", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"Drop", "[", 
         RowBox[{"gr", ",", "1"}], "]"}]}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.664897266273006*^9, 3.6648972869781523`*^9}, {
   3.6652361011607924`*^9, 3.665236101200748*^9}, {3.6786085775692797`*^9, 
   3.678608681007144*^9}, 3.678608771359713*^9, {3.679816635346476*^9, 
   3.6798166683460503`*^9}, {3.679816718986203*^9, 3.67981672025688*^9}, {
   3.679817134929941*^9, 3.6798171350882597`*^9}, {3.679817430205175*^9, 
   3.679817430979395*^9}, {3.6798348764740267`*^9, 3.679834876625701*^9}, {
   3.784552502692132*^9, 3.784552505715926*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"dbcd654e-c05a-43ad-9ec0-156ed24b14b8"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{35, Automatic}, {Automatic, 14}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 867, 16, 73, "Input",ExpressionUUID->"b63ba021-b85d-45b0-ad55-3dcdfefbd11c"],
Cell[CellGroupData[{
Cell[1450, 40, 155, 3, 67, "Section",ExpressionUUID->"b027ae07-e0de-45be-a8ee-222be405f984"],
Cell[CellGroupData[{
Cell[1630, 47, 159, 3, 54, "Subsection",ExpressionUUID->"5c3bc57c-6381-4c44-a4c2-5e3c84c1cb93"],
Cell[1792, 52, 448, 8, 30, "Input",ExpressionUUID->"2007e4d1-9919-4240-80f7-a4a4834975c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2277, 65, 219, 4, 54, "Subsection",ExpressionUUID->"45375a06-0300-4f18-af04-66e6bfe2635a"],
Cell[2499, 71, 993, 16, 30, "Input",ExpressionUUID->"bb7ff7d3-e996-4157-81c4-7c12f8b44f6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3529, 92, 203, 4, 54, "Subsection",ExpressionUUID->"e90df646-fcda-4e76-95a1-097a6dc8a726"],
Cell[3735, 98, 867, 21, 94, "Input",ExpressionUUID->"7598cbce-75e8-4617-b849-70516c56c850"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4639, 124, 154, 3, 54, "Subsection",ExpressionUUID->"8bf4a371-0a2a-4091-8622-4544c2d5461d"],
Cell[4796, 129, 726, 16, 30, "Input",ExpressionUUID->"0598c0cf-6f7f-4b0b-aeb6-ee6a1b34e5d8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5571, 151, 155, 3, 67, "Section",ExpressionUUID->"3933406c-be1b-4618-8fde-27cc791625f0"],
Cell[CellGroupData[{
Cell[5751, 158, 224, 4, 54, "Subsection",ExpressionUUID->"8762112d-92e9-40b5-98f1-1e8eb827c2a7"],
Cell[5978, 164, 3153, 77, 283, "Input",ExpressionUUID->"e8d54abb-8ba7-4cc8-9cc8-48cbd5eff9b0"],
Cell[9134, 243, 612, 13, 30, "Input",ExpressionUUID->"bc825aeb-2306-4db2-9129-50b953e44b61"],
Cell[9749, 258, 2066, 45, 241, "Input",ExpressionUUID->"db01598d-124c-466f-86f0-abebcb9a8881"],
Cell[11818, 305, 1095, 22, 73, "Input",ExpressionUUID->"37e10211-3cba-4216-8ab3-2e9623dc1e31"],
Cell[12916, 329, 3009, 66, 178, "Input",ExpressionUUID->"d5ce461b-7cab-4cb5-96ad-9907dd643c63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15962, 400, 162, 3, 54, "Subsection",ExpressionUUID->"90556789-4baa-4ee2-8a32-158d1aa849e1"],
Cell[16127, 405, 2188, 60, 178, "Input",ExpressionUUID->"4a133c6e-0fbe-4002-affb-a0bbef930f1b"],
Cell[18318, 467, 1136, 26, 52, "Input",ExpressionUUID->"33dcf3da-9fbb-4ad9-889e-b4c5db0f14f2"],
Cell[CellGroupData[{
Cell[19479, 497, 237, 4, 45, "Subsubsection",ExpressionUUID->"fe63e949-b643-434a-8414-818e4a6a0eda"],
Cell[19719, 503, 4830, 115, 325, "Input",ExpressionUUID->"5938585e-a642-4885-9a15-c8fec56cb381"],
Cell[24552, 620, 775, 21, 52, "Input",ExpressionUUID->"05e5cbcc-a31d-4793-a34f-866db063df58"],
Cell[25330, 643, 249, 3, 35, "Text",ExpressionUUID->"51a49abf-43ae-4d00-ada1-5889cf2114f5"],
Cell[25582, 648, 2845, 61, 178, "Input",ExpressionUUID->"d8bd959d-92f7-4f62-abc9-ff528d98bf31"],
Cell[28430, 711, 327, 6, 35, "Text",ExpressionUUID->"1b96baca-e705-4121-82d6-92a1c20812df"],
Cell[28760, 719, 2890, 61, 178, "Input",ExpressionUUID->"d8937c83-66f8-4ad2-8867-5e2098f97939"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31711, 787, 167, 3, 67, "Section",ExpressionUUID->"57a567a8-2e0a-49eb-a223-edf13dfa79a0"],
Cell[31881, 792, 3131, 77, 262, "Input",ExpressionUUID->"324bc95a-d8a7-4207-9d6f-9453ac2cc9f4"],
Cell[35015, 871, 586, 13, 30, "Input",ExpressionUUID->"6653b86f-9553-4ce0-ba8c-38513409f88e"],
Cell[35604, 886, 354, 9, 52, "Input",ExpressionUUID->"cc608168-8866-4451-9099-28534640c68c"],
Cell[35961, 897, 1094, 23, 136, "Input",ExpressionUUID->"855a5f11-c0d4-4978-849c-ef70f1107f19"],
Cell[37058, 922, 218, 4, 30, "Input",ExpressionUUID->"643b70b4-d5de-4ced-ba54-1915c05131a1"],
Cell[37279, 928, 588, 15, 73, "Input",ExpressionUUID->"91b9a41b-16f6-490e-99ff-26fff8ac691c"],
Cell[37870, 945, 219, 4, 30, "Input",ExpressionUUID->"7a8e576b-bfab-4768-8507-572cfc292521"],
Cell[38092, 951, 3919, 83, 262, "Input",ExpressionUUID->"e47c1c30-424e-45bc-a57e-a4b46d1018a0"],
Cell[CellGroupData[{
Cell[42036, 1038, 163, 3, 54, "Subsection",ExpressionUUID->"57219199-5142-45cb-816d-6299a7f8ec9e"],
Cell[42202, 1043, 687, 16, 30, "Input",ExpressionUUID->"5c73a634-0f3a-4d8c-890f-4f7f46d6bc41"],
Cell[42892, 1061, 3124, 68, 241, "Input",ExpressionUUID->"ca02941a-b276-4a49-af7c-e980af66516a"],
Cell[46019, 1131, 321, 7, 30, "Input",ExpressionUUID->"7eb27898-e397-4e8a-89d4-695f0d9be380"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46389, 1144, 181, 3, 67, "Section",ExpressionUUID->"b31a1e1a-5eda-4d31-b18c-158e2a434854"],
Cell[46573, 1149, 1951, 50, 136, "Input",ExpressionUUID->"fe25bef0-d384-433a-b306-0c9b108ed682"],
Cell[48527, 1201, 235, 5, 30, "Input",ExpressionUUID->"f84847b4-375b-4372-b4a7-ba46a1c51c47"],
Cell[48765, 1208, 1095, 31, 94, "Input",ExpressionUUID->"197f4bd1-2155-4992-9ac3-b1f2fd00cadc"],
Cell[49863, 1241, 568, 13, 30, "Input",ExpressionUUID->"a40ca009-6e5a-44e8-a085-2607bfa07417"],
Cell[50434, 1256, 615, 14, 30, "Input",ExpressionUUID->"1ab36bf6-57df-475b-b5c8-b8fbeb157cd0"],
Cell[51052, 1272, 2210, 53, 178, "Input",ExpressionUUID->"02309528-374c-4508-acee-47cbae0725ca"],
Cell[53265, 1327, 402, 9, 30, "Input",ExpressionUUID->"6e042396-058d-4cb1-a1f2-8c167bc59666"],
Cell[53670, 1338, 1437, 39, 115, "Input",ExpressionUUID->"cb8bbef5-e955-4f05-9fbc-8ab22e384171"],
Cell[55110, 1379, 2039, 52, 199, "Input",ExpressionUUID->"320c70e0-752e-46e4-9594-d665dd6e9a4a"],
Cell[CellGroupData[{
Cell[57174, 1435, 214, 4, 54, "Subsection",ExpressionUUID->"d25aaadf-77bb-4b2c-9380-81d725954128"],
Cell[57391, 1441, 3131, 77, 283, "Input",ExpressionUUID->"1d592c6a-97b4-4960-8cd8-679046ddea9d"],
Cell[60525, 1520, 586, 13, 30, "Input",ExpressionUUID->"0641d03a-eb4c-4630-b65d-82d4cf0a3b5e"],
Cell[61114, 1535, 2121, 46, 241, "Input",ExpressionUUID->"f0de3eb1-c7c5-4477-a579-972bb669208b"],
Cell[63238, 1583, 976, 29, 52, "Input",ExpressionUUID->"9e388060-827f-4503-8774-e3dc9b384078"],
Cell[64217, 1614, 808, 18, 73, "Input",ExpressionUUID->"6714884e-cfe0-4537-a97f-501a920e016b"],
Cell[65028, 1634, 799, 21, 80, "Input",ExpressionUUID->"d61ab5a3-d9e8-41f7-b756-de5504747ae0"],
Cell[65830, 1657, 1529, 44, 136, "Input",ExpressionUUID->"224f7ad0-4d2f-4f83-9812-6675538ba290"],
Cell[67362, 1703, 632, 18, 52, "Input",ExpressionUUID->"c7846a91-e9e8-44e7-8d29-9fca7e447690"],
Cell[67997, 1723, 2430, 67, 178, "Input",ExpressionUUID->"edf9054f-4af8-480a-abef-8d89063a8587"],
Cell[70430, 1792, 220, 4, 30, "Input",ExpressionUUID->"2a991510-9291-4c01-a284-7f735f9ab883"],
Cell[70653, 1798, 494, 13, 30, "Input",ExpressionUUID->"0129f645-2cd3-495d-8000-d5c890f147ec"],
Cell[CellGroupData[{
Cell[71172, 1815, 239, 4, 45, "Subsubsection",ExpressionUUID->"b37a58c9-2173-418d-95ca-2c8e98745f1a"],
Cell[71414, 1821, 364, 10, 30, "Input",ExpressionUUID->"79934a1f-0a52-4017-8176-7b49e752b330"],
Cell[71781, 1833, 1475, 40, 136, "Input",ExpressionUUID->"4672bdb1-9b0f-4821-b28c-356142e60b25"],
Cell[73259, 1875, 2033, 54, 136, "Input",ExpressionUUID->"f131b4de-f7ab-4171-838d-e6adc311421f"],
Cell[75295, 1931, 1813, 49, 157, "Input",ExpressionUUID->"78e113fd-0135-42b8-8ef5-d649793bc319"],
Cell[77111, 1982, 430, 8, 30, "Input",ExpressionUUID->"b2f6caaa-1660-4d28-96d7-93e3a9896809"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77590, 1996, 168, 3, 54, "Subsection",ExpressionUUID->"db4ba137-b4f6-4b36-b08a-aa6c066a48b4"],
Cell[CellGroupData[{
Cell[77783, 2003, 164, 3, 45, "Subsubsection",ExpressionUUID->"02d69268-787d-46d2-8163-401eee8c672b"],
Cell[77950, 2008, 747, 19, 52, "Input",ExpressionUUID->"3d0f3b63-1542-4018-93ff-5d5fbd18f188"],
Cell[78700, 2029, 2307, 55, 115, "Input",ExpressionUUID->"e8eb8bbc-7e47-44b3-b990-544f2657889d"],
Cell[81010, 2086, 2518, 60, 136, "Input",ExpressionUUID->"f76ff661-ac0b-44c2-aa45-ef1dc687f65e"],
Cell[83531, 2148, 868, 19, 52, "Input",ExpressionUUID->"256d17ad-746c-449c-82d5-80e4aa3fee53"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84448, 2173, 172, 3, 54, "Subsection",ExpressionUUID->"d529bc67-23b8-429f-b927-e69472b3e832"],
Cell[84623, 2178, 2452, 57, 136, "Input",ExpressionUUID->"c1adcaf9-29f7-43be-bbe2-5074e95f723b"],
Cell[87078, 2237, 367, 7, 30, "Input",ExpressionUUID->"5497c41f-30b4-474c-998c-6c03f271999b"],
Cell[87448, 2246, 1958, 50, 157, "Input",ExpressionUUID->"e2f62058-4216-4ede-8d4d-29d0415316dc"],
Cell[89409, 2298, 388, 10, 30, "Input",ExpressionUUID->"922b27ef-02b1-4ee9-98e6-3b6a761b27ef"],
Cell[89800, 2310, 1067, 25, 52, "Input",ExpressionUUID->"dbcd654e-c05a-43ad-9ec0-156ed24b14b8"]
}, Open  ]]
}, Open  ]]
}
]
*)

